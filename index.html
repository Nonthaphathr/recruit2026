<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
    <link rel="icon" type="image/png" href="https://nonthaphathr.github.io/uploadimg/logoschool.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&family=Prompt:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #c2185b;
            --primary-light: #e91e63;
            --primary-dark: #880e4f;
            --accent: #f06292;
            --accent-light: #f8bbd0;
            --accent-dark: #ad1457;
            --bg: #fce4ec;
            --bg-secondary: #f8bbd0;
            --card-bg: #ffffff;
            --overlay-bg: rgba(0, 0, 0, 0.6);
            --text: #2d3748;
            --text-light: #718096;
            --text-lighter: #a0aec0;
            --border: #f8bbd0;
            --border-light: #fce4ec;
            --success: #38a169;
            --success-light: #48bb78;
            --danger: #e53e3e;
            --danger-light: #fc8181;
            --warning: #ed8936;
            --info: #3182ce;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-full: 9999px;
            --font-body: 'Sarabun', sans-serif;
            --font-heading: 'Prompt', sans-serif;
            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-base: 1rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
            --text-2xl: 1.5rem;
            --text-3xl: 1.875rem;
            --text-4xl: 2.25rem;
            --touch-target: 44px;
            --button-height: 48px;
            --input-height: 48px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, var(--bg) 0%, var(--bg-secondary) 100%);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            font-weight: 600;
            line-height: 1.3;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: var(--space-md) var(--space-lg);
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .settings-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg) scale(1.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .logo-section img {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-full);
            border: 3px solid var(--accent);
            background: white;
            padding: 2px;
            flex-shrink: 0;
        }

        .logo-text h1 {
            font-size: clamp(1rem, 4vw, 1.25rem);
            font-weight: 600;
            letter-spacing: 0.3px;
            line-height: 1.3;
        }

        .logo-text p {
            font-size: clamp(0.75rem, 3vw, 0.875rem);
            opacity: 0.95;
            margin-top: 2px;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: clamp(1rem, 3vw, 2rem);
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: clamp(1rem, 3vw, 2rem);
            align-items: start;
        }

        .form-section {
            background: var(--card-bg);
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }

        .form-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: clamp(1rem, 3vw, 1.5rem) clamp(1rem, 4vw, 2rem);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .form-header-icon {
            width: clamp(40px, 10vw, 48px);
            height: clamp(40px, 10vw, 48px);
            background: var(--accent);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.25rem, 5vw, 1.5rem);
            flex-shrink: 0;
        }

        .form-header h2 {
            font-size: clamp(1rem, 4vw, 1.25rem);
            font-weight: 600;
            line-height: 1.3;
        }

        .form-header p {
            font-size: clamp(0.8rem, 3vw, 0.875rem);
            opacity: 0.95;
            margin-top: 2px;
        }

        .form-body {
            padding: clamp(1rem, 4vw, 2rem);
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: var(--space-sm);
            color: var(--text);
            font-size: var(--text-base);
        }

        .form-group label .required {
            color: var(--danger);
            margin-left: 2px;
        }

        .form-group label span {
            font-size: var(--text-sm);
            color: var(--text-light);
            font-weight: 400;
        }

        .form-control {
            width: 100%;
            padding: clamp(0.75rem, 3vw, 1rem);
            min-height: var(--input-height);
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            font-family: var(--font-body);
            font-size: var(--text-base);
            transition: all 0.3s ease;
            background: white;
            color: var(--text);
            -webkit-appearance: none;
            appearance: none;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 54, 93, 0.1);
        }

        .form-control::placeholder {
            color: var(--text-lighter);
        }

        select.form-control {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23718096' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 12px;
            padding-right: 2.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            margin-top: var(--space-sm);
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            cursor: pointer;
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            transition: background 0.2s ease;
            min-height: var(--touch-target);
        }

        .checkbox-item:hover {
            background: var(--bg);
        }

        .checkbox-item input[type="checkbox"],
        .checkbox-item input[type="radio"] {
            width: 22px;
            height: 22px;
            min-width: 22px;
            min-height: 22px;
            accent-color: var(--primary);
            cursor: pointer;
            margin: 0;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-size: var(--text-base);
            line-height: 1.5;
        }

        .form-actions {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            margin-top: var(--space-xl);
            padding-top: var(--space-lg);
            border-top: 2px solid var(--border);
        }

        .btn {
            padding: clamp(0.875rem, 3vw, 1rem) clamp(1rem, 4vw, 1.5rem);
            min-height: var(--button-height);
            border-radius: var(--radius-lg);
            font-family: var(--font-body);
            font-size: var(--text-base);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            border: none;
            white-space: nowrap;
            text-align: center;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: var(--text-sm);
            border-radius: var(--radius-md);
            min-height: 36px;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-light);
        }

        .history-panel {
            background: var(--card-bg);
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            height: fit-content;
            animation: fadeIn 0.5s ease 0.1s both;
        }

        .history-header {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
            color: var(--primary);
            padding: clamp(1rem, 3vw, 1.25rem) clamp(1rem, 3vw, 1.5rem);
        }

        .history-header h3 {
            font-size: clamp(1rem, 3.5vw, 1.1rem);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-sm);
            margin-bottom: var(--space-sm);
        }

        .history-count {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: var(--text-sm);
            font-weight: 600;
        }

        .history-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .history-item {
            padding: var(--space-md) clamp(1rem, 3vw, 1.5rem);
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background: var(--bg);
        }

        .history-item:active {
            background: var(--bg-secondary);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-sm);
            gap: var(--space-sm);
        }

        .history-item-type {
            font-size: var(--text-xs);
            padding: 0.25rem 0.5rem;
            background: var(--primary);
            color: white;
            border-radius: var(--radius-sm);
            font-weight: 500;
            white-space: nowrap;
        }

        .history-item-date {
            font-size: var(--text-xs);
            color: var(--text-light);
            text-align: right;
        }

        .history-item-name {
            font-weight: 600;
            color: var(--text);
            margin-bottom: var(--space-xs);
            font-size: var(--text-base);
        }

        .history-item-detail {
            font-size: var(--text-sm);
            color: var(--text-light);
        }

        .history-item-actions {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .empty-history {
            padding: var(--space-2xl) var(--space-lg);
            text-align: center;
            color: var(--text-light);
        }

        .empty-history svg {
            width: 64px;
            height: 64px;
            margin-bottom: var(--space-md);
            opacity: 0.5;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay-bg);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--space-md);
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius-2xl);
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-xl);
            animation: modalSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            padding: clamp(1rem, 3vw, 1.5rem);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-md);
        }

        .modal-header h3 {
            font-size: clamp(1.1rem, 4vw, 1.25rem);
            flex: 1;
        }

        .modal-close {
            width: clamp(36px, 10vw, 40px);
            height: clamp(36px, 10vw, 40px);
            min-width: var(--touch-target);
            min-height: var(--touch-target);
            border: none;
            background: var(--bg);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: clamp(1.25rem, 4vw, 1.5rem);
            color: var(--text-light);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: clamp(0.5rem, 2vw, 1rem);
            background: var(--bg-secondary);
        }

        .modal-footer {
            padding: clamp(1rem, 3vw, 1.5rem);
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        #previewArea {
            background: white;
            min-height: 200px;
        }

        #previewArea .print-document {
            margin: 0 auto;
            box-shadow: var(--shadow-lg);
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--success);
            color: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
            font-size: var(--text-base);
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--danger);
        }

        .print-document {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 8mm 10mm;
            font-family: var(--font-body);
            font-size: 15px;
            line-height: 1.5;
            color: black;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .print-document .doc-code {
            text-align: right;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .print-document .doc-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            position: relative;
        }

        .print-document .doc-logo-section {
            text-align: center;
            flex: 1;
        }

        .print-document .doc-logo {
            width: 110px;
            height: 110px;
            margin: 0 auto;
        }

        .print-document .doc-title-section {
            text-align: center;
            margin-top: 8px;
        }

        .print-document .doc-school-info {
            position: absolute;
            right: 0;
            top: 0;
            text-align: right;
            font-size: 13px;
            line-height: 1.5;
        }

        .print-document .doc-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            margin: 5px 0;
        }

        .print-document .doc-content {
            margin-bottom: 5px;
        }

        .print-document .doc-content p {
            margin-bottom: 4px;
        }

        .print-document .field-line {
            display: flex;
            align-items: baseline;
            gap: 4px;
            margin: 3px 0;
            line-height: 1.6;
        }

        .print-document .field-label {
            font-size: 14px;
        }

        .print-document .field-value {
            font-weight: 600;
            border-bottom: 1px dotted #333;
            min-width: 100px;
            display: inline-block;
        }

        .print-document .checkbox-line {
            display: flex;
            align-items: flex-start;
            gap: 6px;
            margin: 2px 0 2px 25px;
            line-height: 1.4;
        }

        .print-document .doc-checkbox {
            display: inline-block;
            width: 13px;
            height: 13px;
            min-width: 13px;
            min-height: 13px;
            border: 1.5px solid #333;
            background: white;
            position: relative;
            flex-shrink: 0;
            margin-top: 3px;
        }

        .print-document .doc-checkbox.checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            font-weight: bold;
            color: #333;
            line-height: 1;
        }

        .print-document .signature-section {
            margin-top: 15px;
            text-align: right;
            padding-right: 20px;
        }

        .print-document .signature-section p {
            margin: 2px 0;
        }

        .print-document .approval-section {
            margin-top: 15px;
            border-top: 1px solid #666;
            padding-top: 10px;
        }

        .print-document .approval-box {
            border: 1px solid #666;
            padding: 8px 10px;
            font-size: 13px;
            margin-top: 8px;
        }

        .print-document .approval-box-title {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 13px;
        }

        .print-document .approval-box p {
            margin: 2px 0;
        }

        .print-document .id-boxes {
            display: flex;
            gap: 2px;
            align-items: center;
        }

        .print-document .id-box {
            width: 18px;
            height: 22px;
            border: 1.5px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .print-document .id-dash {
            width: 8px;
            height: 2px;
            background: #333;
            margin: 0 1px;
        }

        #printArea {
            display: none;
        }

        @media print {
            *, *::before, *::after {
                background: transparent !important;
                background-color: transparent !important;
                box-shadow: none !important;
            }
            
            html, body {
                width: 210mm !important;
                height: auto !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                background-color: white !important;
            }
            
            body > * {
                display: none !important;
                visibility: hidden !important;
            }
            
            /* ‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß */
            body:not([data-print="mobtua"]) #printArea {
                display: block !important;
                visibility: visible !important;
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                background-color: white !important;
            }
            
            body:not([data-print="mobtua"]) #printArea * {
                visibility: visible !important;
            }

            /* ‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ data-print="mobtua" */
            body[data-print="mobtua"] #mobtuaPrintArea {
                display: block !important;
                visibility: visible !important;
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
            }

            body[data-print="mobtua"] #mobtuaPrintArea * {
                visibility: visible !important;
            }
            
            .print-document {
                display: block !important;
                visibility: visible !important;
                width: 100% !important;
                min-height: auto !important;
                padding: 5mm 10mm !important;
                margin: 0 !important;
                box-shadow: none !important;
                font-size: 14px !important;
                page-break-inside: avoid !important;
                background: white !important;
                background-color: white !important;
            }
            
            .print-document .approval-box {
                background: white !important;
                background-color: white !important;
            }
            
            @page {
                size: A4 portrait;
                margin: 10mm;
            }
            
            .print-document,
            .print-document * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            .print-document .approval-box {
                border: 1px solid #666 !important;
            }
            
            .print-document .doc-checkbox {
                border: 1.5px solid #333 !important;
                background: white !important;
            }

            /* mobtua 2-page break */
            .mobtua-page-1 {
                page-break-after: always !important;
            }
            .mobtua-page-2 {
                page-break-before: always !important;
            }
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                display: flex;
                flex-direction: column;
            }
            .form-section {
                order: 1;
                width: 100%;
            }
            .history-panel {
                order: 2;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }
            .modal-footer {
                flex-direction: column;
            }
            .modal-footer .btn {
                width: 100%;
            }
            .print-document {
                width: 100%;
                padding: 5mm;
                font-size: 11px;
            }
            .toast {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
            }
        }

        @media (min-width: 769px) {
            .form-actions, .modal-footer {
                flex-direction: row;
                justify-content: flex-end;
            }
            .history-panel {
                position: sticky;
                top: 100px;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Landing Page Styles */
        .landing-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 120px);
            padding: var(--space-2xl);
        }

        .landing-page h2 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            color: var(--primary);
            margin-bottom: var(--space-xl);
            text-align: center;
        }

        .grade-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-xl);
            max-width: 800px;
            width: 100%;
        }

        .grade-card {
            background: white;
            border-radius: var(--radius-2xl);
            padding: var(--space-2xl);
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            border: 3px solid transparent;
        }

        .grade-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .grade-card-icon {
            font-size: 4rem;
            margin-bottom: var(--space-md);
        }

        .grade-card h3 {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: var(--space-sm);
        }

        .grade-card p {
            color: var(--text-light);
            font-size: var(--text-base);
        }

        .hidden {
            display: none !important;
        }

        .history-locked-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: var(--text-xs);
            color: var(--danger);
            background: #fff5f5;
            border: 1px solid var(--danger-light);
            padding: 2px 8px;
            border-radius: var(--radius-full);
            font-weight: 600;
        }

        .btn-edit {
            background: var(--info);
            color: white;
        }

        .btn-edit:hover {
            background: #2b6cb0;
        }


        /* ===== ‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß modal ===== */
        .mobtua-modal {
            z-index: 1050;
        }
        .mobtua-modal .modal-content {
            max-width: 1100px;
            width: 100%;
            height: 92vh;
            max-height: 92vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .mobtua-modal .modal-header {
            flex-shrink: 0;
        }
        .mobtua-modal .modal-body {
            background: white;
            padding: 1.25rem 1.75rem;
            overflow-y: scroll;
            overflow-x: hidden;
            flex: 1 1 0;
            min-height: 0;
        }
        .mobtua-modal .form-actions {
            flex-shrink: 0;
            position: sticky;
            bottom: 0;
            background: white;
            border-top: 2px solid var(--border);
            padding: 1rem 0 0.5rem;
            margin-top: 1rem;
            z-index: 10;
        }
        @media (max-width: 768px) {
            .mobtua-modal .modal-body { padding: 1rem; }
            .mobtua-modal .modal-content { height: 100vh; max-height: 100vh; border-radius: 0; }
        }
        /* form-row ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ + ‡∏ä‡∏∑‡πà‡∏≠ + ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• */
        .form-row-prefix {
            display: grid;
            grid-template-columns: 140px 1fr 1fr;
            gap: var(--space-md);
        }
        @media (max-width: 768px) {
            .form-row-prefix {
                grid-template-columns: 1fr 1fr;
            }
            .form-row-prefix .form-group:first-child {
                grid-column: 1 / -1;
            }
        }

        .section-divider {
            color: #7b3f9e;
            margin: var(--space-xl) 0 var(--space-lg);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid #e9d5f9;
            font-size: 1rem;
        }

        /* Print document for ‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß */
        .mobtua-doc {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 8mm 12mm;
            font-family: 'Sarabun', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: black;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: relative;
        }
        .mobtua-doc .mt-doc-header-row {
            display: flex;
            align-items: flex-start;
            margin-bottom: 6px;
        }
        .mobtua-doc .mt-logo {
            width: 90px;
            height: 90px;
            flex-shrink: 0;
        }
        .mobtua-doc .mt-title-center {
            flex: 1;
            text-align: center;
            padding-top: 8px;
        }
        .mobtua-doc .mt-title-center h2 {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            font-family: 'Prompt', sans-serif;
        }
        .mobtua-doc .mt-title-center p {
            font-size: 15px;
            font-weight: 600;
            margin: 2px 0 0;
            font-family: 'Prompt', sans-serif;
        }
        .mobtua-doc .mt-topright {
            width: 120px;
            border: 1.5px solid #333;
            padding: 5px 8px;
            font-size: 12px;
            line-height: 1.8;
            flex-shrink: 0;
        }
        .mobtua-doc .mt-field {
            display: inline;
        }
        .mobtua-doc .mt-line {
            border-bottom: 1px dotted #333;
            display: inline-block;
            min-width: 80px;
            font-weight: 600;
            text-align: center;
            vertical-align: bottom;
        }
        .mobtua-doc .mt-section-title {
            font-weight: 700;
            margin: 6px 0 2px;
        }
        .mobtua-doc .mt-para {
            margin: 3px 0;
            line-height: 1.6;
        }
        .mobtua-doc .mt-checkbox-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 2px 0;
        }
        .mobtua-doc .mt-cb {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-right: 10px;
        }
        .mobtua-doc .mt-box {
            width: 13px;
            height: 13px;
            border: 1.5px solid #333;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            flex-shrink: 0;
            vertical-align: middle;
        }
        .mobtua-doc .mt-sig-row {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            gap: 20px;
        }
        .mobtua-doc .mt-sig-block {
            text-align: center;
            flex: 1;
        }
        .mobtua-doc .mt-doclist {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2px 16px;
            font-size: 12.5px;
            margin-top: 6px;
        }
        .mobtua-doc .mt-doclist-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .mobtua-doc .mt-divider {
            border-top: 1px solid #555;
            margin: 8px 0;
        }
        .mobtua-doc .mt-id-boxes {
            display: inline-flex;
            gap: 2px;
            align-items: center;
            vertical-align: middle;
        }
        .mobtua-doc .mt-id-box {
            width: 16px;
            height: 20px;
            border: 1.5px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
        }
        .mobtua-doc .mt-id-dash {
            width: 6px;
            height: 2px;
            background: #333;
        }
        .mobtua-doc .mt-code {
            text-align: right;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 3px;
        }
        .mobtua-doc .mt-nowrap {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .mobtua-doc .mobtua-page-1 {
            padding-bottom: 10px;
        }
        .mobtua-doc .mobtua-page-2 {
            border-top: 2px dashed #ccc;
            padding-top: 10px;
            margin-top: 10px;
        }
        @media print {
            .mobtua-doc {
                width: 100% !important;
                min-height: auto !important;
                padding: 5mm 10mm !important;
                margin: 0 !important;
                box-shadow: none !important;
                font-size: 13px !important;
            }
            .mobtua-doc .mobtua-page-2 {
                border-top: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="https://nonthaphathr.github.io/uploadimg/logoschool.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                <div class="logo-text">
                    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
                    <p>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©</p>
                    <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 4px;">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏ô‡∏ô‡∏ó‡∏û‡∏±‡∏ó‡∏ò‡πå ‡∏´‡∏¥‡∏£‡∏±‡∏ç‡πÄ‡∏£‡∏∑‡∏≠‡∏á ‡∏á‡∏≤‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏≠‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                </div>
            </div>
            <button class="settings-btn" onclick="openAdminSettings()" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô">
                ‚öôÔ∏è
            </button>
        </div>
    </header>

    <!-- Landing Page -->
    <div class="landing-page" id="landingPage">
        <h2>üìù ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
        <div class="grade-selection" style="max-width: 1100px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));">
            <div class="grade-card" onclick="selectGrade('m1')">
                <div class="grade-card-icon">üéí</div>
                <h3>‡∏°.1</h3>
                <p>‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</p>
            </div>
            <div class="grade-card" onclick="selectGrade('m4')">
                <div class="grade-card-icon">üéì</div>
                <h3>‡∏°.4</h3>
                <p>‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</p>
            </div>
            <div class="grade-card" onclick="openMobTuaForm()" style="border-color: #7b3f9e;">
                <div class="grade-card-icon">üìã</div>
                <h3 style="color: #7b3f9e;">‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</h3>
                <p>‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-container hidden" id="mainContainer">
        <!-- Form Section -->
        <div class="form-section">
            <div class="form-header">
                <div class="form-header-icon">üìù</div>
                <div style="flex:1;">
                    <h2 id="formTitle">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</h2>
                    <p id="formCode">‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.202</p>
                    <span id="autosaveBadgeAdmission" style="font-size:0.75rem;opacity:0;transition:opacity 0.5s;background:rgba(255,255,255,0.25);padding:2px 8px;border-radius:999px;margin-top:4px;display:inline-block;"></span>
                </div>
            </div>
            <div class="form-body">
                <form id="admissionForm">
                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                    <h3 style="color: var(--primary); margin-bottom: var(--space-lg); padding-bottom: var(--space-sm); border-bottom: 2px solid var(--border);">
                        üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£
                    </h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô <span class="required">*</span></label>
                            <select class="form-control" name="gradeLevel" id="gradeLevel" required onchange="updateFormTitle()">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --</option>
                                <option value="m1">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                                <option value="m4">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="academicYear" id="academicYear" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <span class="required">*</span></label>
                            <input type="date" class="form-control" name="applicationDate" required>
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ <span class="required">*</span></label>
                            <select class="form-control" name="prefix" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="firstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
                            <input type="text" class="form-control" name="lastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î <span class="required">*</span></label>
                            <input type="number" class="form-control" name="birthDay" required min="1" max="31" placeholder="‡∏ß‡∏±‡∏ô (1-31)" id="birthDay">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î <span class="required">*</span></label>
                            <select class="form-control" name="birthMonth" required id="birthMonth">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="1">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                                <option value="2">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                                <option value="3">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                                <option value="4">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                                <option value="5">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                                <option value="6">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                                <option value="7">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                                <option value="8">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                                <option value="9">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                                <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                                <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                                <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î ‡∏û.‡∏®. <span class="required">*</span></label>
                            <input type="number" class="form-control" name="birthYear" required min="2500" max="2570" placeholder="‡∏û.‡∏®. (‡πÄ‡∏ä‡πà‡∏ô 2555)" id="birthYear">
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ) <span class="required">*</span></label>
                            <input type="number" class="form-control" name="age" required placeholder="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥" id="ageField" readonly style="background-color: #f0f0f0;">
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏î</label>
                            <select class="form-control" name="bloodType">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="O">O</option>
                                <option value="AB">AB</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
                            <input type="text" class="form-control" name="nickname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)</label>
                            <input type="number" class="form-control" name="height" placeholder="‡πÄ‡∏ä‡πà‡∏ô 145">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</label>
                            <input type="number" class="form-control" name="weight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 35">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (13 ‡∏´‡∏•‡∏±‡∏Å) <span class="required">*</span></label>
                        <input type="text" class="form-control" name="nationalId" required maxlength="17" placeholder="x-xxxx-xxxxx-xx-x" id="nationalIdInput">
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤ -->
                    <h3 style="color: var(--primary); margin: var(--space-xl) 0 var(--space-lg); padding-bottom: var(--space-sm); border-bottom: 2px solid var(--border);">
                        üë®‚Äçüë©‚Äçüë¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤
                    </h3>

                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏¥‡∏î‡∏≤ <span class="required">*</span></label>
                            <select class="form-control" name="fatherPrefix" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏¥‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="fatherFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ö‡∏¥‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="fatherLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group" style="display:none;">
                            <input type="hidden" name="fatherName" id="fatherNameHidden">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏¢‡∏∏‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="number" class="form-control" name="fatherAge" placeholder="‡πÄ‡∏ä‡πà‡∏ô 45">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ö‡∏¥‡∏î‡∏≤</label>
                        <input type="text" class="form-control" name="fatherOccupation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£">
                    </div>

                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤ <span class="required">*</span></label>
                            <select class="form-control" name="motherPrefix" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏£‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="motherFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="motherLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group" style="display:none;">
                            <input type="hidden" name="motherName" id="motherNameHidden">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏¢‡∏∏‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="number" class="form-control" name="motherAge" placeholder="‡πÄ‡∏ä‡πà‡∏ô 42">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                        <input type="text" class="form-control" name="motherOccupation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢">
                    </div>

                    <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -->
                    <h3 style="color: var(--primary); margin: var(--space-xl) 0 var(--space-lg); padding-bottom: var(--space-sm); border-bottom: 2px solid var(--border);">
                        üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                    </h3>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="houseNumber" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 123">
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="moo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 5">
                        </div>
                        <div class="form-group">
                            <label>‡∏ñ‡∏ô‡∏ô</label>
                            <input type="text" class="form-control" name="road" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏¥‡∏ï‡∏£‡∏†‡∏≤‡∏û">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ã‡∏≠‡∏¢</label>
                            <input type="text" class="form-control" name="soi" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå">
                        </div>
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô/‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô</label>
                            <input type="text" class="form-control" name="village" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• <span class="required">*</span></label>
                            <input type="text" class="form-control" name="subdistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="district" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span class="required">*</span></label>
                            <input type="text" class="form-control" name="province" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå <span class="required">*</span></label>
                            <input type="text" class="form-control" name="postalCode" required maxlength="5" placeholder="‡πÄ‡∏ä‡πà‡∏ô 33130">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="tel" class="form-control" name="phone" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-234-5678">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <input type="text" class="form-control" name="email" placeholder='‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏™‡πà "-"'>
                        </div>
                    </div>

                    <!-- ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏° -->
                    <h3 style="color: var(--primary); margin: var(--space-xl) 0 var(--space-lg); padding-bottom: var(--space-sm); border-bottom: 2px solid var(--border);">
                        üè´ ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°
                    </h3>

                    <div class="form-group">
                        <label>‡∏à‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6 ‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                        <input type="text" class="form-control" name="previousSchool" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå">
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• <span class="required">*</span></label>
                            <input type="text" class="form-control" name="schoolSubdistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="schoolDistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span class="required">*</span></label>
                            <input type="text" class="form-control" name="schoolProvince" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
                        </div>
                    </div>

                    <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏© -->
                    <h3 style="color: var(--primary); margin: var(--space-xl) 0 var(--space-lg); padding-bottom: var(--space-sm); border-bottom: 2px solid var(--border);">
                        ‚≠ê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©
                    </h3>

                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="talent" value="sports">
                            <span>‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤ (‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó)</span>
                        </label>
                    </div>
                    <div class="form-group" id="sportsTypeGroup" style="display: none; margin-left: 2rem;">
                        <input type="text" class="form-control" name="sportsType" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏µ‡∏¨‡∏≤">
                    </div>

                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="talent" value="music">
                            <span>‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏î‡∏ô‡∏ï‡∏£‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡∏∞ (‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó)</span>
                        </label>
                    </div>
                    <div class="form-group" id="musicTypeGroup" style="display: none; margin-left: 2rem;">
                        <input type="text" class="form-control" name="musicType" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏î‡∏ô‡∏ï‡∏£‡∏µ/‡∏®‡∏¥‡∏•‡∏õ‡∏∞">
                    </div>

                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="talent" value="other">
                            <span>‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏)</span>
                        </label>
                    </div>
                    <div class="form-group" id="otherTalentGroup" style="display: none; margin-left: 2rem;">
                        <input type="text" class="form-control" name="otherTalent" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                    </div>

                    <!-- Actions -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-primary" onclick="previewDocument()">
                            üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                        </button>
                        <button type="button" class="btn btn-success" onclick="saveDocument()">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                        </button>
                        <button type="reset" class="btn btn-outline" onclick="clearAutosave(AUTOSAVE_KEY_ADMISSION)">
                            üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="button" class="btn btn-warning hidden" id="testDataBtn" onclick="fillTestData()" style="background: #f59e0b; color: white;">
                            üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- History Panel -->
        <aside class="history-panel">
            <div class="history-header">
                <h3>
                    üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£
                    <span class="history-count" id="historyCount">0</span>
                </h3>
                <div style="display:flex; align-items:center; gap:8px; margin-top:4px;">
                    <span class="history-locked-badge hidden" id="historyLockedBadge">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</span>
                </div>
            </div>
            <div class="history-list" id="historyList">
                <div class="empty-history">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
                </div>
            </div>
        </aside>
    </main>

    <!-- Preview Modal -->
    <div class="modal-overlay" id="previewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="previewArea"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-success" onclick="printDocument()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
            </div>
        </div>
    </div>

    <!-- ===== ‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Modal ===== -->
    <div class="modal-overlay mobtua-modal" id="mobtuaModal">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #7b3f9e, #9c4dcc); color: white; flex-shrink: 0;">
                <h3 style="flex:1;">
                    üìã ‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205
                    <span id="autosaveBadgeMobtua" style="font-size:0.7rem;opacity:0;transition:opacity 0.5s;background:rgba(255,255,255,0.2);padding:2px 8px;border-radius:999px;margin-left:8px;vertical-align:middle;display:inline-block;"></span>
                </h3>
                <button class="modal-close" onclick="closeMobtuaModal()" style="background: rgba(255,255,255,0.2); color: white;">&times;</button>
            </div>
            <div class="modal-body">
                <form id="mobtuaForm">
                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ç‡∏ß‡∏≤ -->
                    <h3 class="section-divider">üî¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)</h3>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                            <input type="text" class="form-control" name="mt_studentId" placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô / ‡∏´‡πâ‡∏≠‡∏á</label>
                            <input type="text" class="form-control" name="mt_classRoom" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°.1/2">
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                            <input type="text" class="form-control" name="mt_academicYear" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2568" id="mt_academicYear">
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á -->
                    <h3 class="section-divider">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</h3>
                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á <span class="required">*</span></label>
                            <select class="form-control" name="mt_guardianPrefix" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianNationalId" required maxlength="17" placeholder="x-xxxx-xxxxx-xx-x" id="mt_guardianNationalIdInput">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</label>
                            <input type="text" class="form-control" name="mt_guardianOccupation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£">
                        </div>
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                            <input type="text" class="form-control" name="mt_guardianWorkplace" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏î‡∏∏‡∏°">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianHouseNo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianMoo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
                        </div>
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianSubdistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianDistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_guardianProvince" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                            <input type="text" class="form-control" name="mt_guardianPostal" maxlength="5" placeholder="‡πÄ‡∏ä‡πà‡∏ô 33130">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡πâ‡∏≤‡∏ô</label>
                            <input type="text" class="form-control" name="mt_guardianHomePhone" placeholder="-">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label>
                            <input type="text" class="form-control" name="mt_guardianMobile" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-234-5678">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô <span class="required">*</span></label>
                            <select class="form-control" name="mt_guardianRelation" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ö‡∏¥‡∏î‡∏≤">‡∏ö‡∏¥‡∏î‡∏≤</option>
                                <option value="‡∏°‡∏≤‡∏£‡∏î‡∏≤">‡∏°‡∏≤‡∏£‡∏î‡∏≤</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏)</option>
                            </select>
                        </div>
                        <div class="form-group" id="mt_guardianRelationOtherGroup" style="display:none;">
                            <label>‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</label>
                            <input type="text" class="form-control" name="mt_guardianRelationOther" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏π‡πà ‡∏¢‡πà‡∏≤ ‡∏ï‡∏≤ ‡∏¢‡∏≤‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" class="form-control" name="mt_guardianIncome" placeholder="‡πÄ‡∏ä‡πà‡∏ô 9000">
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
                    <h3 class="section-divider">üéí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                            <select class="form-control" name="mt_studentPrefix" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_studentFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_studentLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
                            <input type="text" class="form-control" name="mt_studentNickname" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡πà‡∏á">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î (‡∏ß‡∏±‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_birthDay" min="1" max="31" placeholder="1-31" id="mt_birthDay">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
                            <select class="form-control" name="mt_birthMonth" id="mt_birthMonth">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                                <option value="‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                                <option value="‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                                <option value="‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                                <option value="‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                                <option value="‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î ‡∏û.‡∏®.</label>
                            <input type="number" class="form-control" name="mt_birthYear" min="2500" max="2570" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2555" id="mt_birthYear">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥</label>
                            <input type="text" class="form-control" name="mt_nationality" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥</label>
                            <input type="text" class="form-control" name="mt_ethnicity" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡∏®‡∏≤‡∏™‡∏ô‡∏≤</label>
                            <input type="text" class="form-control" name="mt_religion" placeholder="‡∏û‡∏∏‡∏ó‡∏ò" value="‡∏û‡∏∏‡∏ó‡∏ò">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)</label>
                            <input type="number" class="form-control" name="mt_height" placeholder="‡πÄ‡∏ä‡πà‡∏ô 155">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</label>
                            <input type="number" class="form-control" name="mt_weight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 45">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
                            <input type="text" class="form-control" name="mt_disease" placeholder="‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏™‡πà -">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                        <input type="text" class="form-control" name="mt_studentNationalId" required maxlength="17" placeholder="x-xxxx-xxxxx-xx-x" id="mt_studentNationalIdInput">
                    </div>

                    <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô -->
                    <h3 class="section-divider">üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô)</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô</label>
                            <input type="text" class="form-control" name="mt_houseCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô 11 ‡∏´‡∏•‡∏±‡∏Å">
                        </div>
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_houseNo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 14">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_moo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
                        </div>
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_subdistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_district" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_province" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                            <input type="text" class="form-control" name="mt_postal" maxlength="5" placeholder="‡πÄ‡∏ä‡πà‡∏ô 33130">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label>
                            <input type="text" class="form-control" name="mt_mobile" placeholder="‡πÄ‡∏ä‡πà‡∏ô 069-789-8989">
                        </div>
                    </div>

                    <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -->
                    <h3 class="section-divider">üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</h3>
                    <div class="form-group" style="margin-bottom: var(--space-md);">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="mt_sameAddress" onchange="copyAddressToCurrentMT()" style="width: 20px; height: 20px;">
                            <span>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</span>
                        </label>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</label>
                            <input type="text" class="form-control" name="mt_curHouseCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô 11 ‡∏´‡∏•‡∏±‡∏Å">
                        </div>
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_curHouseNo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 14">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_curMoo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
                        </div>
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_curSubdistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_curDistrict" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_curProvince" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</label>
                            <input type="text" class="form-control" name="mt_curPostal" maxlength="5" placeholder="‡πÄ‡∏ä‡πà‡∏ô 33130">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</label>
                            <input type="text" class="form-control" name="mt_curMobile" placeholder="‡πÄ‡∏ä‡πà‡∏ô 069-789-8989">
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
                    <h3 class="section-divider">‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h3>
                    <div class="form-group">
                        <label>‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ô‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                        <div class="checkbox-group" style="flex-direction: row; flex-wrap: wrap; gap: 1rem; margin-top: 0.5rem;">
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_sleeping" value="‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥" required>
                                <span>‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_sleeping" value="‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤">
                                <span>‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_sleeping" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                                <span>‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏</span>
                            </label>
                        </div>
                        <input type="text" class="form-control" name="mt_sleepingOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏ (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÜ)" style="margin-top: 0.5rem;">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ <span class="required">*</span></label>
                            <div class="checkbox-group" style="flex-direction: row; gap: 1rem; margin-top: 0.5rem;">
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_disadvantaged" value="‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™" required>
                                    <span>‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</span>
                                </label>
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_disadvantaged" value="‡πÑ‡∏°‡πà‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™">
                                    <span>‡πÑ‡∏°‡πà‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á)</label>
                        <div class="checkbox-group" style="flex-direction: row; flex-wrap: wrap; gap: 0.5rem 1rem; margin-top: 0.5rem;">
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="checkbox" name="mt_transport" value="‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤">
                                <span>‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="checkbox" name="mt_transport" value="‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô">
                                <span>‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="checkbox" name="mt_transport" value="‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á">
                                <span>‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="checkbox" name="mt_transport" value="‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå">
                                <span>‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="checkbox" name="mt_transport" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                                <span>‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏</span>
                            </label>
                        </div>
                        <input type="text" class="form-control" name="mt_transportOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏ (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÜ)" style="margin-top: 0.5rem;">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                            <input type="number" class="form-control" name="mt_travelTime" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ö‡πâ‡∏≤‡∏ô (‡∏Å‡∏°./‡πÄ‡∏°‡∏ï‡∏£)</label>
                            <input type="text" class="form-control" name="mt_travelDistance" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ñ‡∏ô ‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á)</label>
                            <input type="number" class="form-control" name="mt_siblings" placeholder="‡πÄ‡∏ä‡πà‡∏ô 4">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏∏‡∏ï‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà</label>
                            <input type="number" class="form-control" name="mt_birthOrder" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3">
                        </div>
                        <div class="form-group">
                            <label>‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡∏π‡πà (‡∏Ñ‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_siblingsStudying" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
                        </div>
                    </div>
                    <div class="form-row" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="form-group">
                            <label>‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢ (‡∏Ñ‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_olderBrothers" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢ (‡∏Ñ‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_youngerBrothers" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß (‡∏Ñ‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_olderSisters" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß (‡∏Ñ‡∏ô)</label>
                            <input type="number" class="form-control" name="mt_youngerSisters" placeholder="0">
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏î‡∏≤ -->
                    <h3 class="section-divider">üë® ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏î‡∏≤</h3>
                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <select class="form-control" name="mt_fatherPrefix">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏¥‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_fatherFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ö‡∏¥‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_fatherLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherNationalId" maxlength="17" placeholder="x-xxxx-xxxxx-xx-x" id="mt_fatherNationalIdInput">
                        </div>
                    </div>
                    <div class="form-row" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="form-group">
                            <label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherNationality" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherEthnicity" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherReligion" placeholder="‡∏û‡∏∏‡∏ó‡∏ò" value="‡∏û‡∏∏‡∏ó‡∏ò">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <div class="checkbox-group" style="flex-direction: row; gap: 1rem; margin-top: 0.5rem;">
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_fatherAlive" value="‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà">
                                    <span>‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà</span>
                                </label>
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_fatherAlive" value="‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">
                                    <span>‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherEducation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°.6, ‡∏õ.‡∏ï‡∏£‡∏µ">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherOccupation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£">
                        </div>
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherWorkplace" placeholder="‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• (‡∏ö‡∏¥‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_fatherSubdistrict" placeholder="‡∏ï‡∏≥‡∏ö‡∏•">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡∏ö‡∏¥‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_fatherDistrict" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏ö‡∏¥‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_fatherProvince" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ö‡∏¥‡∏î‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" class="form-control" name="mt_fatherIncome" placeholder="‡πÄ‡∏ä‡πà‡∏ô 9000">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ö‡∏¥‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_fatherMobile" placeholder="‡πÄ‡∏ä‡πà‡∏ô 069-789-8989">
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤ -->
                    <h3 class="section-divider">üë© ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤</h3>
                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <select class="form-control" name="mt_motherPrefix">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏£‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_motherFirstName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤ <span class="required">*</span></label>
                            <input type="text" class="form-control" name="mt_motherLastName" required placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherNationalId" maxlength="17" placeholder="x-xxxx-xxxxx-xx-x" id="mt_motherNationalIdInput">
                        </div>
                    </div>
                    <div class="form-row" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="form-group">
                            <label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherNationality" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherEthnicity" placeholder="‡πÑ‡∏ó‡∏¢" value="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherReligion" placeholder="‡∏û‡∏∏‡∏ó‡∏ò" value="‡∏û‡∏∏‡∏ó‡∏ò">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <div class="checkbox-group" style="flex-direction: row; gap: 1rem; margin-top: 0.5rem;">
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_motherAlive" value="‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà">
                                    <span>‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà</span>
                                </label>
                                <label class="checkbox-item" style="min-height: auto;">
                                    <input type="radio" name="mt_motherAlive" value="‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">
                                    <span>‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherEducation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°.6, ‡∏õ.‡∏ï‡∏£‡∏µ">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherOccupation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£">
                        </div>
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherWorkplace" placeholder="‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏• (‡∏°‡∏≤‡∏£‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_motherSubdistrict" placeholder="‡∏ï‡∏≥‡∏ö‡∏•">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡∏°‡∏≤‡∏£‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_motherDistrict" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏°‡∏≤‡∏£‡∏î‡∏≤)</label>
                            <input type="text" class="form-control" name="mt_motherProvince" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" class="form-control" name="mt_motherIncome" placeholder="‡πÄ‡∏ä‡πà‡∏ô 9000">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                            <input type="text" class="form-control" name="mt_motherMobile" placeholder="‡πÄ‡∏ä‡πà‡∏ô 088-234-5678">
                        </div>
                    </div>

                    <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤ -->
                    <h3 class="section-divider">üë®‚Äçüë©‚Äçüë¶ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤</h3>
                    <div class="form-group">
                        <div class="checkbox-group" style="flex-direction: row; flex-wrap: wrap; gap: 0.5rem 1.5rem; margin-top: 0.5rem;">
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô">
                                <span>‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà">
                                <span>‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡∏≠‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á">
                                <span>‡∏≠‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡∏ö‡∏¥‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">
                                <span>‡∏ö‡∏¥‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡∏°‡∏≤‡∏£‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">
                                <span>‡∏°‡∏≤‡∏£‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</span>
                            </label>
                            <label class="checkbox-item" style="min-height: auto;">
                                <input type="radio" name="mt_parentStatus" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                                <span>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                            </label>
                        </div>
                        <input type="text" class="form-control" name="mt_parentStatusOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏ (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÜ)" style="margin-top: 0.5rem;">
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤ -->
                    <h3 class="section-divider">üë• ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤)</h3>
                    <p style="font-size: var(--text-sm); color: var(--text-light); margin-bottom: 1rem;">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤</p>
                    <div class="form-row-prefix">
                        <div class="form-group">
                            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                            <select class="form-control" name="mt_altGuardianPrefix">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                            <input type="text" class="form-control" name="mt_altGuardianFirstName" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" class="form-control" name="mt_altGuardianLastName" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô</label>
                            <input type="text" class="form-control" name="mt_altGuardianRelation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏π‡πà ‡∏¢‡πà‡∏≤ ‡∏ï‡∏≤ ‡∏¢‡∏≤‡∏¢ ‡∏•‡∏∏‡∏á ‡∏õ‡πâ‡∏≤">
                        </div>
                    </div>
                    <div class="form-row" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="form-group">
                            <label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥</label>
                            <input type="text" class="form-control" name="mt_altGuardianNationality" placeholder="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥</label>
                            <input type="text" class="form-control" name="mt_altGuardianEthnicity" placeholder="‡πÑ‡∏ó‡∏¢">
                        </div>
                        <div class="form-group">
                            <label>‡∏®‡∏≤‡∏™‡∏ô‡∏≤</label>
                            <input type="text" class="form-control" name="mt_altGuardianReligion" placeholder="‡∏û‡∏∏‡∏ó‡∏ò">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</label>
                            <input type="text" class="form-control" name="mt_altGuardianOccupation" placeholder="‡∏≠‡∏≤‡∏ä‡∏µ‡∏û">
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" class="form-control" name="mt_altGuardianIncome" placeholder="‡πÄ‡∏ä‡πà‡∏ô 8000">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
                            <input type="text" class="form-control" name="mt_altGuardianHouseNo" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà</label>
                            <input type="text" class="form-control" name="mt_altGuardianMoo" placeholder="‡∏´‡∏°‡∏π‡πà">
                        </div>
                        <div class="form-group">
                            <label>‡∏ñ‡∏ô‡∏ô</label>
                            <input type="text" class="form-control" name="mt_altGuardianRoad" placeholder="‡∏ñ‡∏ô‡∏ô">
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>‡∏ï‡∏≥‡∏ö‡∏•</label>
                            <input type="text" class="form-control" name="mt_altGuardianSubdistrict" placeholder="‡∏ï‡∏≥‡∏ö‡∏•">
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
                            <input type="text" class="form-control" name="mt_altGuardianDistrict" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                            <input type="text" class="form-control" name="mt_altGuardianProvince" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                            <input type="text" class="form-control" name="mt_altGuardianWorkplace" placeholder="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">
                        </div>
                        <div class="form-group">
                            <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label>
                            <input type="text" class="form-control" name="mt_altGuardianMobile" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
                        </div>
                    </div>

                    <!-- ‡∏õ‡∏∏‡πà‡∏° action -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-primary" onclick="previewMobtuaDocument()" style="background: linear-gradient(135deg, #7b3f9e, #9c4dcc);">
                            üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                        </button>
                        <button type="button" class="btn btn-success" onclick="saveMobtuaDocument()">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                        </button>
                        <button type="reset" class="btn btn-outline" style="color: #7b3f9e; border-color: #7b3f9e;" onclick="clearAutosave(AUTOSAVE_KEY_MOBTUA)">
                            üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="button" class="btn hidden" id="mobtuaTestDataBtn" onclick="fillMobtuaTestData()" style="background: #f59e0b; color: white;">
                            üß™ ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                        </button>
                        <button type="button" class="btn btn-outline" onclick="closeMobtuaModal()">
                            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </button>
                    </div>
                </form>

                <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß -->
                <div style="margin-top: 2rem; border-top: 3px solid #e9d5ff; padding-top: 1.5rem;">
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:1rem;">
                        <h3 style="color:#7b3f9e; font-size:1.1rem; display:flex; align-items:center; gap:0.5rem;">
                            üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß
                            <span id="mobtuaHistoryCount" style="background:#7b3f9e; color:white; padding:2px 10px; border-radius:999px; font-size:0.8rem;">0</span>
                        </h3>
                        <span class="history-locked-badge hidden" id="mobtuaLockedBadge">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</span>
                    </div>
                    <div id="mobtuaHistoryList">
                        <div class="empty-history">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width:48px;height:48px;opacity:0.4;margin-bottom:0.5rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß Preview Modal -->
    <div class="modal-overlay" id="mobtuaPreviewModal" style="z-index: 1200;">
        <div class="modal-content" style="max-width: 950px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #7b3f9e, #9c4dcc); color: white;">
                <h3>üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205</h3>
                <button class="modal-close" onclick="closeMobtuaPreviewModal()" style="background: rgba(255,255,255,0.2); color: white;">&times;</button>
            </div>
            <div class="modal-body">
                <div id="mobtuaPreviewArea"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeMobtuaPreviewModal()">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-success" onclick="printMobtuaDocument()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
            </div>
        </div>
    </div>

    <!-- Hidden Print Area for ‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß -->
    <div id="mobtuaPrintArea" style="display:none;"></div>

    <!-- Admin Settings Modal -->
    <div class="modal-overlay" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
                <button class="modal-close" onclick="closeAdminModal()">&times;</button>
            </div>
            <div class="modal-body" style="background: white; padding: 2rem;">
                
                <div style="margin-bottom: 2rem;">
                    <h4 style="margin-bottom: 1rem; color: var(--primary);">üìÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</h4>
                    <div class="form-group">
                        <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</label>
                        <input type="text" class="form-control" id="defaultAcademicYear" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567">
                    </div>
                    <button class="btn btn-primary" onclick="saveDefaultYear()" style="width: 100%;">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
                    </button>
                </div>

                <div style="margin-bottom: 2rem; padding-top: 2rem; border-top: 2px solid var(--border);">
                    <h4 style="margin-bottom: 1rem; color: var(--primary);">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h4>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="historyLockToggle" onchange="toggleHistoryLock()" style="width: 20px; height: 20px;">
                            <span>‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö)</span>
                        </label>
                        <p style="font-size:var(--text-sm); color:var(--text-light); margin-top:6px;">
                            ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Ñ ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                        </p>
                    </div>
                </div>

                <div style="margin-bottom: 2rem; padding-top: 2rem; border-top: 2px solid var(--border);">
                    <h4 style="margin-bottom: 1rem; color: var(--primary);">üß™ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h4>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="testModeToggle" onchange="toggleTestMode()" style="width: 20px; height: 20px;">
                            <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                        </label>
                    </div>
                </div>
                
                <div style="margin-bottom: 2rem; padding-top: 2rem; border-top: 2px solid var(--border);">
                    <h4 style="margin-bottom: 1rem; color: var(--primary);">üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel</h4>
                    <button class="btn btn-success" onclick="exportToExcel()" style="width: 100%; margin-bottom: 0.75rem;">
                        üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (Excel)
                    </button>
                    <button class="btn btn-success" onclick="exportMobtuaToExcel()" style="width: 100%; background: linear-gradient(135deg,#7b3f9e,#9c4dcc);">
                        üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß (Excel)
                    </button>
                </div>
                
                <div style="margin-bottom: 2rem; padding-top: 2rem; border-top: 2px solid var(--border);">
                    <h4 style="margin-bottom: 1rem; color: var(--primary);">üîî ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h4>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="alertToggle" onchange="toggleAlert()" style="width: 20px; height: 20px;">
                            <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®:</label>
                        <textarea class="form-control" id="alertMessage" rows="4" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®..." style="resize: vertical;"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveAlertSettings()" style="width: 100%;">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Record Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body" style="background: white; padding: 1.5rem;">
                <input type="hidden" id="editRecordId">
                <div class="form-group">
                    <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô <span class="required">*</span></label>
                    <select class="form-control" id="editGradeLevel">
                        <option value="m1">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                        <option value="m4">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                    </select>
                </div>
                <div class="form-row-3">
                    <div class="form-group">
                        <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                        <select class="form-control" id="editPrefix">
                            <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                            <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                            <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠ <span class="required">*</span></label>
                        <input type="text" class="form-control" id="editFirstName" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                    </div>
                    <div class="form-group">
                        <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
                        <input type="text" class="form-control" id="editLastName" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                        <input type="text" class="form-control" id="editPhone" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-234-5678">
                    </div>
                    <div class="form-group">
                        <label>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°</label>
                        <input type="text" class="form-control" id="editPreviousSchool" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
                        <input type="text" class="form-control" id="editDistrict" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
                    </div>
                    <div class="form-group">
                        <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                        <input type="text" class="form-control" id="editProvince" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
                    </div>
                </div>
                <p style="font-size:var(--text-sm); color:var(--text-light); margin-top:8px;">
                    * ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeEditModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-success" onclick="saveEditRecord()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal-overlay" id="alertAnnouncementModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #ed8936, #f6ad55); color: white;">
                <h3>üîî ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</h3>
                <button class="modal-close" onclick="closeAlertModal()">&times;</button>
            </div>
            <div class="modal-body" style="background: white; padding: 2rem;">
                <div id="alertContent" style="font-size: 1.1rem; line-height: 1.8; white-space: pre-wrap;"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeAlertModal()">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span id="toastMessage">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, getDoc, doc, deleteDoc, updateDoc, query, orderBy, limit, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAZruE6dHfH2uFjE0TAet7Yys8H5soATVY",
            authDomain: "recruitstudents2026.firebaseapp.com",
            projectId: "recruitstudents2026",
            storageBucket: "recruitstudents2026.firebasestorage.app",
            messagingSenderId: "312157707609",
            appId: "1:312157707609:web:164adccd4f6c95af990048"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.db = db;
        window.firestore = { collection, addDoc, getDocs, getDoc, doc, deleteDoc, updateDoc, query, orderBy, limit, serverTimestamp };

        console.log('Firebase initialized successfully!');
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            setDefaultDate();
        });

        function setupEventListeners() {
            const talentCheckboxes = document.querySelectorAll('input[name="talent"]');
            talentCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.value === 'sports') {
                        document.getElementById('sportsTypeGroup').style.display = this.checked ? 'block' : 'none';
                    } else if (this.value === 'music') {
                        document.getElementById('musicTypeGroup').style.display = this.checked ? 'block' : 'none';
                    } else if (this.value === 'other') {
                        document.getElementById('otherTalentGroup').style.display = this.checked ? 'block' : 'none';
                    }
                });
            });

            document.getElementById('previewModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            ['birthDay', 'birthMonth', 'birthYear'].forEach(id => {
                document.getElementById(id)?.addEventListener('change', calculateAge);
            });

            // Format ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            const nationalIdInput = document.getElementById('nationalIdInput');
            if (nationalIdInput) {
                nationalIdInput.addEventListener('input', formatNationalId);
            }
        }

        function calculateAge() {
            const day = document.getElementById('birthDay')?.value;
            const month = document.getElementById('birthMonth')?.value;
            const year = document.getElementById('birthYear')?.value;
            
            if (day && month && year) {
                const buddhist = parseInt(year);
                const christian = buddhist - 543;
                const birthDate = new Date(christian, parseInt(month) - 1, parseInt(day));
                const today = new Date();
                
                let age = today.getFullYear() - birthDate.getFullYear();
                const monthDiff = today.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                document.getElementById('ageField').value = age;
            }
        }

        function formatNationalId(e) {
            let value = e.target.value.replace(/[^0-9]/g, '');
            
            if (value.length > 13) {
                value = value.substring(0, 13);
            }
            
            let formatted = '';
            if (value.length > 0) formatted += value.substring(0, 1);
            if (value.length > 1) formatted += '-' + value.substring(1, 5);
            if (value.length > 5) formatted += '-' + value.substring(5, 10);
            if (value.length > 10) formatted += '-' + value.substring(10, 12);
            if (value.length > 12) formatted += '-' + value.substring(12, 13);
            
            e.target.value = formatted;
        }

        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('input[name="applicationDate"]').value = today;
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å localStorage
            const defaultYear = localStorage.getItem('defaultAcademicYear');
            if (defaultYear) {
                document.getElementById('academicYear').value = defaultYear;
            } else {
                const currentYear = new Date().getFullYear() + 543;
                document.getElementById('academicYear').value = currentYear;
            }
        }

        function selectGrade(grade) {
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('mainContainer').classList.remove('hidden');
            
            const gradeSelect = document.getElementById('gradeLevel');
            gradeSelect.value = grade;
            updateFormTitle();
        }

        function updateFormTitle() {
            const gradeLevel = document.getElementById('gradeLevel').value;
            const formTitle = document.getElementById('formTitle');
            const formCode = document.getElementById('formCode');
            
            if (gradeLevel === 'm1') {
                formTitle.textContent = '‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1';
                formCode.textContent = '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.202';
            } else if (gradeLevel === 'm4') {
                formTitle.textContent = '‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4';
                formCode.textContent = '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.203';
            }
        }

        function getFormData() {
            const form = document.getElementById('admissionForm');
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                if (key === 'talent') {
                    if (!data[key]) data[key] = [];
                    data[key].push(value);
                } else {
                    data[key] = value;
                }
            }
            
            // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            if (data.firstName && data.lastName) {
                data.fullName = data.firstName + ' ' + data.lastName;
            }

            // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ö‡∏¥‡∏î‡∏≤
            if (data.fatherFirstName || data.fatherLastName) {
                data.fatherName = `${data.fatherPrefix || ''} ${data.fatherFirstName || ''} ${data.fatherLastName || ''}`.trim();
            }

            // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤
            if (data.motherFirstName || data.motherLastName) {
                data.motherName = `${data.motherPrefix || ''} ${data.motherFirstName || ''} ${data.motherLastName || ''}`.trim();
            }
            
            // ‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
            if (data.birthDay && data.birthMonth && data.birthYear) {
                const buddhist = parseInt(data.birthYear);
                const christian = buddhist - 543;
                data.birthDate = `${christian}-${String(data.birthMonth).padStart(2, '0')}-${String(data.birthDay).padStart(2, '0')}`;
            }
            
            // ‡∏•‡∏ö "-" ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
            if (data.nationalId) {
                data.nationalIdClean = data.nationalId.replace(/[^0-9]/g, '');
            }
            
            return data;
        }

        function validateForm() {
            const form = document.getElementById('admissionForm');
            return form.checkValidity();
        }

        function formatThaiDate(dateString) {
            if (!dateString) return '....................';
            const date = new Date(dateString);
            const thaiMonths = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', 
                               '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
            const day = date.getDate();
            const month = thaiMonths[date.getMonth()];
            const year = date.getFullYear() + 543;
            return `${day} ${month} ${year}`;
        }

        function formatIdBoxes(id) {
            // ‡πÉ‡∏ä‡πâ nationalIdClean ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ nationalId
            const cleanId = id || '';
            
            if (!cleanId || cleanId.length !== 13) {
                const boxes = [];
                for (let i = 0; i < 13; i++) {
                    if (i === 1 || i === 5 || i === 10 || i === 12) {
                        boxes.push('<span class="id-dash"></span>');
                    }
                    boxes.push('<span class="id-box"></span>');
                }
                return boxes.join('');
            }
            
            const digits = cleanId.split('');
            const boxes = [];
            digits.forEach((digit, i) => {
                if (i === 1 || i === 5 || i === 10 || i === 12) {
                    boxes.push('<span class="id-dash"></span>');
                }
                boxes.push(`<span class="id-box">${digit}</span>`);
            });
            return boxes.join('');
        }

        function checkbox(isChecked) {
            return `<span class="doc-checkbox${isChecked ? ' checked' : ''}"></span>`;
        }

        function generateDocumentHTML(data) {
            const logoUrl = 'https://nonthaphathr.github.io/uploadimg/logoschool.png';
            const talents = data.talent || [];
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ü‡∏≠‡∏£‡πå‡∏°
            let gradeText = '‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1';
            let formCode = '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.202';
            
            if (data.gradeLevel === 'm4') {
                gradeText = '‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4';
                formCode = '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.203';
            }
            
            return `
                <div class="print-document">
                    <div class="doc-code">${formCode}</div>
                    
                    <div class="doc-header">
                        <div class="doc-logo-section">
                            <img src="${logoUrl}" class="doc-logo" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                        </div>
                        <div class="doc-school-info">
                            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formatThaiDate(data.applicationDate)}
                        </div>
                    </div>

                    <div class="doc-title-section">
                        <div class="doc-title">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô${gradeText} ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${data.academicYear || '.........................'}</div>
                        <div style="text-align: center; font-size: 14px; margin: 4px 0;">
                            ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©<br>
                            ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©
                        </div>
                    </div>

                    <div class="doc-content">
                        <div class="field-line" style="margin-top: 8px;">
                            <span class="field-label">1. ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</span>
                            <span class="field-value">${data.prefix || ''}${data.fullName || '..........................................'}</span>
                            <span class="field-label">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</span>
                            <span class="field-value">${data.nickname || '..............'}</span>
                            <span class="field-label">‡πÄ‡∏Å‡∏¥‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                            <span class="field-value">${formatThaiDate(data.birthDate)}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏≠‡∏≤‡∏¢‡∏∏</span>
                            <span class="field-value">${data.age || '............'}</span>
                            <span class="field-label">‡∏õ‡∏µ</span>
                        </div>
                        <div class="field-line">
                            <span class="field-label">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á</span>
                            <span class="field-value">${data.height || '..................'}</span>
                            <span class="field-label">‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£</span>
                            <span class="field-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å</span>
                            <span class="field-value">${data.weight || '....................'}</span>
                            <span class="field-label">‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°</span>
                            <span class="field-label">‡∏´‡∏°‡∏π‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏î</span>
                            <span class="field-value">${data.bloodType || '.................................'}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</span>
                            <div class="id-boxes" style="display: inline-flex; gap: 2px; align-items: center;">
                                ${formatIdBoxes(data.nationalIdClean || data.nationalId)}
                            </div>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ö‡∏¥‡∏î‡∏≤</span>
                            <span class="field-value">${data.fatherName || '.....................................................................'}</span>
                            <span class="field-label">‡∏≠‡∏≤‡∏¢‡∏∏</span>
                            <span class="field-value">${data.fatherAge || '........................'}</span>
                            <span class="field-label">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</span>
                            <span class="field-value">${data.fatherOccupation || '.....................................'}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤</span>
                            <span class="field-value">${data.motherName || '.....................................................................'}</span>
                            <span class="field-label">‡∏≠‡∏≤‡∏¢‡∏∏</span>
                            <span class="field-value">${data.motherAge || '........................'}</span>
                            <span class="field-label">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</span>
                            <span class="field-value">${data.motherOccupation || '.....................................'}</span>
                        </div>

                        <div class="field-line" style="margin-top: 6px;">
                            <span class="field-label">2. ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</span>
                            <span class="field-value">${data.houseNumber || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶'}</span>
                            <span class="field-label">‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà</span>
                            <span class="field-value">${data.moo || '‚Ä¶‚Ä¶‚Ä¶'}</span>
                            <span class="field-label">‡∏ñ‡∏ô‡∏ô</span>
                            <span class="field-value">${data.road || '‚Ä¶........‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶'}</span>
                            <span class="field-label">‡∏ã‡∏≠‡∏¢</span>
                            <span class="field-value">${data.soi || '......................'}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏ö‡πâ‡∏≤‡∏ô</span>
                            <span class="field-value">${data.village || '..................................'}</span>
                            <span class="field-label">‡∏ï‡∏≥‡∏ö‡∏•</span>
                            <span class="field-value">${data.subdistrict || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶'}</span>
                            <span class="field-label">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</span>
                            <span class="field-value">${data.district || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..'}</span>
                            <span class="field-label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
                            <span class="field-value">${data.province || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.....‚Ä¶‚Ä¶‚Ä¶‚Ä¶.'}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</span>
                            <span class="field-value">${data.postalCode || '‚Ä¶‚Ä¶............‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶'}</span>
                            <span class="field-label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</span>
                            <span class="field-value">${data.phone || '.‚Ä¶..‚Ä¶‚Ä¶‚Ä¶...........................................‚Ä¶....'}</span>
                            <span class="field-label">E-mail</span>
                            <span class="field-value">${data.email || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶'}</span>
                        </div>

                        <div class="field-line" style="margin-top: 6px;">
                            <span class="field-label">3. ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6 ‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
                            <span class="field-value">${data.previousSchool || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..‚Ä¶‚Ä¶‚Ä¶..'}</span>
                        </div>

                        <div class="field-line">
                            <span class="field-label">‡∏ï‡∏≥‡∏ö‡∏•</span>
                            <span class="field-value">${data.schoolSubdistrict || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.'}</span>
                            <span class="field-label">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</span>
                            <span class="field-value">${data.schoolDistrict || '‚Ä¶...‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..'}</span>
                            <span class="field-label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
                            <span class="field-value">${data.schoolProvince || '‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.'}</span>
                        </div>

                        <p style="margin-top: 8px; font-weight: 600;">4. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
                        
                        <div class="checkbox-line">
                            ${checkbox(talents.includes('sports'))} ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤(‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó) <strong>${talents.includes('sports') ? (data.sportsType || '') : '................................................................................'}</strong>
                        </div>
                        
                        <div class="checkbox-line">
                            ${checkbox(talents.includes('music'))} ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏î‡∏ô‡∏ï‡∏£‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡∏∞(‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó) <strong>${talents.includes('music') ? (data.musicType || '') : '.............................................................'}</strong>
                        </div>
                        
                        <div class="checkbox-line">
                            ${checkbox(talents.includes('other'))} ‡∏≠‡∏∑‡πà‡∏ô‡πÜ(‡∏£‡∏∞‡∏ö‡∏∏) <strong>${talents.includes('other') ? (data.otherTalent || '') : '........................................................................................................'}</strong>
                        </div>
                    </div>

                    <div class="signature-section" style="text-align: right; margin-top: 12px;">
                        <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠..........................................................................‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
                        <p>(.......................................................................)</p>
                        <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.................‡πÄ‡∏î‡∏∑‡∏≠‡∏ô...............................‡∏û.‡∏®................</p>
                    </div>

                    <div class="approval-section">
                        <p style="font-weight: 600; margin-bottom: 6px;">‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 13px;">
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢ 2 ‡πÅ‡∏ú‡πà‡∏ô
                            </div>
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô(‡∏õ‡∏û.1)‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á
                            </div>
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏£/‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤
                            </div>
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏£/‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤
                            </div>
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                            </div>
                            <div class="checkbox-line" style="margin: 2px 0;">
                                ${checkbox(false)} ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.
                            </div>
                        </div>

                        <div style="text-align: right; margin-top: 12px;">
                            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠.............................................................‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
                            <p>(.......................................................)</p>
                            <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.................‡πÄ‡∏î‡∏∑‡∏≠‡∏ô..............................‡∏û.‡∏®...............</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function previewDocument() {
            if (!validateForm()) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                document.getElementById('admissionForm').reportValidity();
                return;
            }

            const data = getFormData();
            const html = generateDocumentHTML(data);
            
            document.getElementById('previewArea').innerHTML = html;
            document.getElementById('printArea').innerHTML = html;
            document.getElementById('previewModal').classList.add('active');
        }

        async function saveDocument() {
            if (!validateForm()) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                document.getElementById('admissionForm').reportValidity();
                return;
            }

            const data = getFormData();
            await saveToFirestore(data);
            
            const html = generateDocumentHTML(data);
            document.getElementById('previewArea').innerHTML = html;
            document.getElementById('printArea').innerHTML = html;
            document.getElementById('previewModal').classList.add('active');
        }

        async function saveToFirestore(data) {
            try {
                showLoading(true);

                const gradeText = data.gradeLevel === 'm4' ? '‡∏°.4' : '‡∏°.1';
                const formCode = data.gradeLevel === 'm4' ? '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.203' : '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.202';

                const record = {
                    formType: `‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${gradeText}`,
                    formCode: formCode,
                    gradeLevel: data.gradeLevel,
                    studentName: `${data.prefix || ''}${data.fullName || ''}`,
                    academicYear: data.academicYear,
                    data: data,
                    createdAt: window.firestore.serverTimestamp(),
                    updatedAt: window.firestore.serverTimestamp()
                };

                const docRef = await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'admissions'),
                    record
                );

                console.log('Document written with ID:', docRef.id);
                showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                await loadHistory();
                // ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞ autosave ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                document.getElementById('admissionForm').reset();
                clearAutosave(AUTOSAVE_KEY_ADMISSION);
                setDefaultDate();

            } catch (error) {
                console.error('Error adding document:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function loadHistory() {
            try {
                showLoading(true);

                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'admissions'),
                    window.firestore.orderBy('createdAt', 'desc'),
                    window.firestore.limit(50)
                );

                const querySnapshot = await window.firestore.getDocs(q);
                const history = [];

                querySnapshot.forEach((doc) => {
                    history.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                const historyList = document.getElementById('historyList');
                const historyCount = document.getElementById('historyCount');
                
                historyCount.textContent = history.length;

                if (history.length === 0) {
                    historyList.innerHTML = `
                        <div class="empty-history">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
                        </div>
                    `;
                    return;
                }

                const isLocked = localStorage.getItem('historyLocked') === 'true';

                historyList.innerHTML = history.map(record => {
                    let dateStr = '-';
                    if (record.createdAt) {
                        const date = record.createdAt.toDate();
                        dateStr = date.toLocaleDateString('th-TH', {
                            year: 'numeric',
                            month: 'short',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                    }

                    const gradeLabel = record.gradeLevel === 'm4' ? '‡∏°.4' : '‡∏°.1';
                    const actionButtons = isLocked
                        ? `<span style="font-size:var(--text-xs); color:var(--text-light);">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>`
                        : `<button class="btn btn-edit btn-sm" onclick="openEditRecord('${record.id}')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                           <button class="btn btn-danger btn-sm" onclick="deleteHistoryRecord('${record.id}')">üóëÔ∏è ‡∏•‡∏ö</button>`;

                    return `
                        <div class="history-item">
                            <div class="history-item-header">
                                <span class="history-item-type">${gradeLabel} - ${record.formCode}</span>
                                <span class="history-item-date">${dateStr}</span>
                            </div>
                            <div class="history-item-name">${record.studentName || '-'}</div>
                            <div class="history-item-detail">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${record.academicYear || '-'}</div>
                            <div class="history-item-actions">
                                <button class="btn btn-primary btn-sm" onclick="viewHistoryRecord('${record.id}')">üëÅÔ∏è ‡∏î‡∏π</button>
                                ${actionButtons}
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Error loading history:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function viewHistoryRecord(id) {
            try {
                showLoading(true);
                const docRef = window.firestore.doc(window.db, 'admissions', id);
                const docSnap = await window.firestore.getDoc(docRef);
                
                if (docSnap.exists()) {
                    const record = docSnap.data();
                    const html = generateDocumentHTML(record.data);
                    
                    document.getElementById('previewArea').innerHTML = html;
                    document.getElementById('printArea').innerHTML = html;
                    document.getElementById('previewModal').classList.add('active');
                } else {
                    showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                }
            } catch (error) {
                console.error('Error viewing record:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function deleteHistoryRecord(id) {
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°
            if (localStorage.getItem('historyLocked') === 'true') {
                showToast('‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ', 'error');
                return;
            }

            const password = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö:');
            if (password === null) return;
            if (password !== '1111') {
                showToast('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                return;
            }

            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ? ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ')) return;

            try {
                showLoading(true);
                await window.firestore.deleteDoc(window.firestore.doc(window.db, 'admissions', id));
                showToast('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                await loadHistory();
            } catch (error) {
                console.error('Error deleting record:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        function closeModal() {
            document.getElementById('previewModal').classList.remove('active');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        async function openEditRecord(id) {
            if (localStorage.getItem('historyLocked') === 'true') {
                showToast('‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ', 'error');
                return;
            }

            try {
                showLoading(true);
                const docRef = window.firestore.doc(window.db, 'admissions', id);
                const docSnap = await window.firestore.getDoc(docRef);

                if (!docSnap.exists()) {
                    showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                    return;
                }

                const record = docSnap.data();
                const d = record.data || {};

                // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á modal
                document.getElementById('editRecordId').value = id;
                document.getElementById('editGradeLevel').value = record.gradeLevel || 'm1';
                document.getElementById('editPrefix').value = d.prefix || '‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢';
                document.getElementById('editFirstName').value = d.firstName || '';
                document.getElementById('editLastName').value = d.lastName || '';
                document.getElementById('editPhone').value = d.phone || '';
                document.getElementById('editPreviousSchool').value = d.previousSchool || '';
                document.getElementById('editDistrict').value = d.district || '';
                document.getElementById('editProvince').value = d.province || '';

                document.getElementById('editModal').classList.add('active');

            } catch (error) {
                console.error('Error loading record:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function saveEditRecord() {
            const id = document.getElementById('editRecordId').value;
            const firstName = document.getElementById('editFirstName').value.trim();
            const lastName = document.getElementById('editLastName').value.trim();

            if (!firstName || !lastName) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', 'error');
                return;
            }

            try {
                showLoading(true);

                const gradeLevel = document.getElementById('editGradeLevel').value;
                const prefix = document.getElementById('editPrefix').value;
                const fullName = firstName + ' ' + lastName;
                const gradeText = gradeLevel === 'm4' ? '‡∏°.4' : '‡∏°.1';
                const formCode = gradeLevel === 'm4' ? '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.203' : '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.202';

                // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô
                const docRef = window.firestore.doc(window.db, 'admissions', id);
                const docSnap = await window.firestore.getDoc(docRef);
                const oldData = docSnap.data();
                const oldInnerData = oldData.data || {};

                // merge ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                const updatedInnerData = {
                    ...oldInnerData,
                    prefix,
                    firstName,
                    lastName,
                    fullName,
                    phone: document.getElementById('editPhone').value,
                    previousSchool: document.getElementById('editPreviousSchool').value,
                    district: document.getElementById('editDistrict').value,
                    province: document.getElementById('editProvince').value,
                    gradeLevel
                };

                await window.firestore.updateDoc(docRef, {
                        gradeLevel,
                        formType: `‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${gradeText}`,
                        formCode,
                        studentName: `${prefix}${fullName}`,
                        data: updatedInnerData,
                        updatedAt: window.firestore.serverTimestamp()
                    });

                showToast('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                closeEditModal();
                await loadHistory();

            } catch (error) {
                console.error('Error updating record:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        function toggleHistoryLock() {
            const locked = document.getElementById('historyLockToggle').checked;
            localStorage.setItem('historyLocked', locked);
            applyHistoryLockUI(locked);
        }

        function applyHistoryLockUI(locked) {
            const badge = document.getElementById('historyLockedBadge');
            if (locked) {
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
            loadHistory(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°
        }

        function printDocument() {
            closeModal();
            setTimeout(() => {
                window.print();
            }, 100);
        }

        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = 'toast show' + (type === 'error' ? ' error' : '');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
        function openAdminSettings() {
            const password = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô:');
            if (password === '1111') {
                loadAdminSettings();
                document.getElementById('adminModal').classList.add('active');
            } else if (password !== null) {
                showToast('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
            }
        }

        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('active');
        }

        function loadAdminSettings() {
            const alertEnabled = localStorage.getItem('alertEnabled') === 'true';
            const alertMessage = localStorage.getItem('alertMessage') || '';
            document.getElementById('alertToggle').checked = alertEnabled;
            document.getElementById('alertMessage').value = alertMessage;

            const defaultYear = localStorage.getItem('defaultAcademicYear') || '';
            document.getElementById('defaultAcademicYear').value = defaultYear;

            const testModeEnabled = localStorage.getItem('testModeEnabled') === 'true';
            document.getElementById('testModeToggle').checked = testModeEnabled;
            toggleTestModeButton(testModeEnabled);

            const historyLocked = localStorage.getItem('historyLocked') === 'true';
            document.getElementById('historyLockToggle').checked = historyLocked;
        }

        function saveDefaultYear() {
            const year = document.getElementById('defaultAcademicYear').value;
            localStorage.setItem('defaultAcademicYear', year);
            document.getElementById('academicYear').value = year;
            showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        function toggleTestMode() {
            const enabled = document.getElementById('testModeToggle').checked;
            localStorage.setItem('testModeEnabled', enabled);
            toggleTestModeButton(enabled);
        }

        function toggleTestModeButton(show) {
            const btn = document.getElementById('testDataBtn');
            if (show) {
                btn.classList.remove('hidden');
            } else {
                btn.classList.add('hidden');
            }
            // sync ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏î‡πâ‡∏ß‡∏¢
            const mobBtn = document.getElementById('mobtuaTestDataBtn');
            if (mobBtn) {
                if (show) mobBtn.classList.remove('hidden');
                else mobBtn.classList.add('hidden');
            }
        }

        function fillMobtuaTestData() {
            const f = (name, val) => {
                const el = document.querySelector(`[name="${name}"]`);
                if (el) el.value = val;
            };
            const r = (name, val) => {
                const el = document.querySelector(`[name="${name}"][value="${val}"]`);
                if (el) el.checked = true;
            };
            const cb = (name, val) => {
                const el = document.querySelector(`[name="${name}"][value="${val}"]`);
                if (el) el.checked = true;
            };

            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            f('mt_studentId', '12345');
            f('mt_classRoom', '‡∏°.1/2');
            f('mt_academicYear', localStorage.getItem('defaultAcademicYear') || (new Date().getFullYear() + 543).toString());

            // ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á
            f('mt_guardianPrefix', '‡∏ô‡∏≤‡∏¢');
            f('mt_guardianFirstName', '‡∏ä‡∏≠‡∏ö');
            f('mt_guardianLastName', '‡∏£‡∏±‡∏Å‡∏î‡∏µ');
            f('mt_guardianNationalId', '3-3305-0999-19-9');
            f('mt_guardianOccupation', '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏°');
            f('mt_guardianWorkplace', '‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏î‡∏∏‡∏°');
            f('mt_guardianHouseNo', '2');
            f('mt_guardianMoo', '2');
            f('mt_guardianSubdistrict', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á');
            f('mt_guardianDistrict', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå');
            f('mt_guardianProvince', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©');
            f('mt_guardianPostal', '33130');
            f('mt_guardianHomePhone', '-');
            f('mt_guardianMobile', '069-789-8989');
            f('mt_guardianRelation', '‡∏ö‡∏¥‡∏î‡∏≤');
            f('mt_guardianIncome', '9000');

            // ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            f('mt_studentPrefix', '‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢');
            f('mt_studentFirstName', '‡πÄ‡∏Å‡πà‡∏á');
            f('mt_studentLastName', '‡∏£‡∏±‡∏Å‡∏î‡∏µ');
            f('mt_studentNickname', '‡πÄ‡∏Å‡πà‡∏á');
            f('mt_birthDay', '2');
            f('mt_birthMonth', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°');
            f('mt_birthYear', '2546');
            f('mt_nationality', '‡πÑ‡∏ó‡∏¢');
            f('mt_ethnicity', '‡πÑ‡∏ó‡∏¢');
            f('mt_religion', '‡∏û‡∏∏‡∏ó‡∏ò');
            f('mt_height', '160');
            f('mt_weight', '45');
            f('mt_disease', '-');
            f('mt_studentNationalId', '1-3302-02214-14-5');

            // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô
            f('mt_houseCode', '3303-021432-7');
            f('mt_houseNo', '14');
            f('mt_moo', '2');
            f('mt_subdistrict', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á');
            f('mt_district', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå');
            f('mt_province', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©');
            f('mt_postal', '33130');
            f('mt_mobile', '069-789-8989');

            // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô)
            f('mt_curHouseCode', '3303-021432-7');
            f('mt_curHouseNo', '14');
            f('mt_curMoo', '2');
            f('mt_curSubdistrict', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á');
            f('mt_curDistrict', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå');
            f('mt_curProvince', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©');
            f('mt_curPostal', '33130');
            f('mt_curMobile', '069-789-8989');

            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
            r('mt_sleeping', '‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤');
            r('mt_disadvantaged', '‡πÑ‡∏°‡πà‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™');
            cb('mt_transport', '‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á');
            f('mt_travelTime', '10');
            f('mt_travelDistance', '5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£');
            f('mt_siblings', '4');
            f('mt_birthOrder', '3');
            f('mt_siblingsStudying', '2');
            f('mt_olderBrothers', '2');
            f('mt_youngerBrothers', '1');
            f('mt_olderSisters', '0');
            f('mt_youngerSisters', '0');

            // ‡∏ö‡∏¥‡∏î‡∏≤
            f('mt_fatherPrefix', '‡∏ô‡∏≤‡∏¢');
            f('mt_fatherFirstName', '‡∏ä‡∏≠‡∏ö');
            f('mt_fatherLastName', '‡∏£‡∏±‡∏Å‡∏î‡∏µ');
            f('mt_fatherNationalId', '3-3305-0999-19-9');
            f('mt_fatherNationality', '‡πÑ‡∏ó‡∏¢');
            f('mt_fatherEthnicity', '‡πÑ‡∏ó‡∏¢');
            f('mt_fatherReligion', '‡∏û‡∏∏‡∏ó‡∏ò');
            r('mt_fatherAlive', '‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà');
            f('mt_fatherEducation', '‡∏°.6');
            f('mt_fatherOccupation', '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£');
            f('mt_fatherWorkplace', '‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏î‡∏∏‡∏°');
            f('mt_fatherSubdistrict', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á');
            f('mt_fatherDistrict', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå');
            f('mt_fatherProvince', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©');
            f('mt_fatherIncome', '9000');
            f('mt_fatherMobile', '069-789-8989');

            // ‡∏°‡∏≤‡∏£‡∏î‡∏≤
            f('mt_motherPrefix', '‡∏ô‡∏≤‡∏á');
            f('mt_motherFirstName', '‡πÄ‡∏û‡∏µ‡∏¢‡∏£');
            f('mt_motherLastName', '‡∏£‡∏±‡∏Å‡∏î‡∏µ');
            f('mt_motherNationalId', '3-3304-0549-19-7');
            f('mt_motherNationality', '‡πÑ‡∏ó‡∏¢');
            f('mt_motherEthnicity', '‡πÑ‡∏ó‡∏¢');
            f('mt_motherReligion', '‡∏û‡∏∏‡∏ó‡∏ò');
            r('mt_motherAlive', '‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà');
            f('mt_motherEducation', '‡∏°.6');
            f('mt_motherOccupation', '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏°');
            f('mt_motherWorkplace', '‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏î‡∏∏‡∏°');
            f('mt_motherSubdistrict', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡∏á');
            f('mt_motherDistrict', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå');
            f('mt_motherProvince', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©');
            f('mt_motherIncome', '9000');
            f('mt_motherMobile', '088-234-5678');

            // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤
            r('mt_parentStatus', '‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô');

            showToast('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        function fillTestData() {
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô
            const gradeLevel = document.getElementById('gradeLevel');
            if (!gradeLevel.value) {
                gradeLevel.value = 'm1';
                updateFormTitle();
            }

            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
            document.querySelector('[name="prefix"]').value = '‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢';
            document.querySelector('[name="firstName"]').value = '‡∏™‡∏°‡∏ä‡∏≤‡∏¢';
            document.querySelector('[name="lastName"]').value = '‡πÉ‡∏à‡∏î‡∏µ';
            document.querySelector('[name="nickname"]').value = '‡∏ä‡∏≤‡∏¢';

            // ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
            document.getElementById('birthDay').value = '15';
            document.getElementById('birthMonth').value = '5';
            document.getElementById('birthYear').value = '2555';
            calculateAge();

            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ
            document.querySelector('[name="bloodType"]').value = 'O';
            document.querySelector('[name="height"]').value = '145';
            document.querySelector('[name="weight"]').value = '35';
            document.getElementById('nationalIdInput').value = '1-2345-67890-12-3';

            // ‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤
            // ‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤
            document.querySelector('[name="fatherPrefix"]').value = '‡∏ô‡∏≤‡∏¢';
            document.querySelector('[name="fatherFirstName"]').value = '‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå';
            document.querySelector('[name="fatherLastName"]').value = '‡πÉ‡∏à‡∏î‡∏µ';
            document.querySelector('[name="fatherAge"]').value = '45';
            document.querySelector('[name="fatherOccupation"]').value = '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£';
            document.querySelector('[name="motherPrefix"]').value = '‡∏ô‡∏≤‡∏á';
            document.querySelector('[name="motherFirstName"]').value = '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á';
            document.querySelector('[name="motherLastName"]').value = '‡πÉ‡∏à‡∏î‡∏µ';
            document.querySelector('[name="motherAge"]').value = '42';
            document.querySelector('[name="motherOccupation"]').value = '‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢';

            // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
            document.querySelector('[name="houseNumber"]').value = '123';
            document.querySelector('[name="moo"]').value = '5';
            document.querySelector('[name="road"]').value = '‡∏°‡∏¥‡∏ï‡∏£‡∏†‡∏≤‡∏û';
            document.querySelector('[name="soi"]').value = '';
            document.querySelector('[name="village"]').value = '‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå';
            document.querySelector('[name="subdistrict"]').value = '‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á';
            document.querySelector('[name="district"]').value = '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå';
            document.querySelector('[name="province"]').value = '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©';
            document.querySelector('[name="postalCode"]').value = '33130';
            document.querySelector('[name="phone"]').value = '081-234-5678';
            document.querySelector('[name="email"]').value = 'test@email.com';

            // ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            document.querySelector('[name="previousSchool"]').value = '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå';
            document.querySelector('[name="schoolSubdistrict"]').value = '‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á';
            document.querySelector('[name="schoolDistrict"]').value = '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå';
            document.querySelector('[name="schoolProvince"]').value = '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©';

            showToast('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        function toggleAlert() {
            const enabled = document.getElementById('alertToggle').checked;
            localStorage.setItem('alertEnabled', enabled);
        }

        function saveAlertSettings() {
            const enabled = document.getElementById('alertToggle').checked;
            const message = document.getElementById('alertMessage').value;
            
            localStorage.setItem('alertEnabled', enabled);
            localStorage.setItem('alertMessage', message);
            
            showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        async function exportToExcel() {
            try {
                showLoading(true);
                
                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'admissions'),
                    window.firestore.orderBy('createdAt', 'desc')
                );
                
                const querySnapshot = await window.firestore.getDocs(q);
                const records = [];
                
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    records.push({
                        '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£': data.createdAt ? new Date(data.createdAt.toDate()).toLocaleDateString('th-TH') : '-',
                        '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô': data.gradeLevel === 'm4' ? '‡∏°.4' : '‡∏°.1',
                        '‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤': data.academicYear || '-',
                        '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•': data.studentName || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô': data.data?.nationalIdClean || data.data?.nationalId || '-',
                        '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î': data.data?.birthDate || '-',
                        '‡∏≠‡∏≤‡∏¢‡∏∏': data.data?.age || '-',
                        '‡∏ö‡∏¥‡∏î‡∏≤': data.data?.fatherName || '-',
                        '‡∏°‡∏≤‡∏£‡∏î‡∏≤': data.data?.motherName || '-',
                        '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': `${data.data?.houseNumber || ''} ‡∏´‡∏°‡∏π‡πà ${data.data?.moo || ''} ‡∏ï.${data.data?.subdistrict || ''} ‡∏≠.${data.data?.district || ''} ‡∏à.${data.data?.province || ''}`,
                        '‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå': data.data?.phone || '-',
                        '‡∏≠‡∏µ‡πÄ‡∏°‡∏•': data.data?.email || '-',
                        '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°': data.data?.previousSchool || '-'
                    });
                });
                
                if (records.length === 0) {
                    showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', 'error');
                    return;
                }
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á CSV
                const headers = Object.keys(records[0]);
                const csvContent = [
                    '\ufeff' + headers.join(','),
                    ...records.map(row => headers.map(header => {
                        const value = row[header] || '';
                        return `"${value.toString().replace(/"/g, '""')}"`;
                    }).join(','))
                ].join('\n');
                
                // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                const today = new Date().toLocaleDateString('th-TH').replace(/\//g, '-');
                
                link.setAttribute('href', url);
                link.setAttribute('download', `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£_${today}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showToast('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                
            } catch (error) {
                console.error('Error exporting data:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        function showAlertIfEnabled() {
            const enabled = localStorage.getItem('alertEnabled') === 'true';
            const message = localStorage.getItem('alertMessage') || '';
            
            if (enabled && message.trim()) {
                document.getElementById('alertContent').textContent = message;
                document.getElementById('alertAnnouncementModal').classList.add('active');
            }
        }

        function closeAlertModal() {
            document.getElementById('alertAnnouncementModal').classList.remove('active');
        }

        // ========== ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205 ==========
        function openMobTuaForm() {
            document.getElementById('mobtuaModal').classList.add('active');
            const defaultYear = localStorage.getItem('defaultAcademicYear');
            if (defaultYear) {
                document.getElementById('mt_academicYear').value = defaultYear;
            } else {
                document.getElementById('mt_academicYear').value = new Date().getFullYear() + 543;
            }
            // ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞ sync lock badge
            loadMobtuaHistory();
            const isLocked = localStorage.getItem('historyLocked') === 'true';
            const badge = document.getElementById('mobtuaLockedBadge');
            if (badge) {
                isLocked ? badge.classList.remove('hidden') : badge.classList.add('hidden');
            }
            // ‡∏ï‡∏±‡πâ‡∏á Autosave + ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
            setupAutosave('mobtuaForm', AUTOSAVE_KEY_MOBTUA);
            promptRestoreAutosave('mobtuaForm', AUTOSAVE_KEY_MOBTUA);
        }

        function closeMobtuaModal() {
            document.getElementById('mobtuaModal').classList.remove('active');
        }

        function closeMobtuaPreviewModal() {
            document.getElementById('mobtuaPreviewModal').classList.remove('active');
        }

        function copyAddressToCurrentMT() {
            const same = document.getElementById('mt_sameAddress').checked;
            if (!same) return;
            const map = {
                mt_curHouseCode: document.querySelector('[name="mt_houseCode"]')?.value,
                mt_curHouseNo: document.querySelector('[name="mt_houseNo"]')?.value,
                mt_curMoo: document.querySelector('[name="mt_moo"]')?.value,
                mt_curSubdistrict: document.querySelector('[name="mt_subdistrict"]')?.value,
                mt_curDistrict: document.querySelector('[name="mt_district"]')?.value,
                mt_curProvince: document.querySelector('[name="mt_province"]')?.value,
                mt_curPostal: document.querySelector('[name="mt_postal"]')?.value,
                mt_curMobile: document.querySelector('[name="mt_mobile"]')?.value,
            };
            Object.entries(map).forEach(([name, val]) => {
                const el = document.querySelector(`[name="${name}"]`);
                if (el && val !== undefined) el.value = val;
            });
        }

        // Setup ID format for ‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß fields
        function setupMobtuaEvents() {
            ['mt_guardianNationalIdInput', 'mt_studentNationalIdInput', 'mt_fatherNationalIdInput', 'mt_motherNationalIdInput'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('input', formatNationalId);
            });

            // Guardian relation other
            document.querySelector('[name="mt_guardianRelation"]')?.addEventListener('change', function() {
                const grp = document.getElementById('mt_guardianRelationOtherGroup');
                if (grp) grp.style.display = this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? 'block' : 'none';
            });
        }

        function getMobtuaFormData() {
            const form = document.getElementById('mobtuaForm');
            const fd = new FormData(form);
            const d = {};
            for (let [k, v] of fd.entries()) {
                if (k === 'mt_transport') {
                    if (!d[k]) d[k] = [];
                    d[k].push(v);
                } else {
                    d[k] = v;
                }
            }
            // ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≤‡∏Å‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÅ‡∏¢‡∏Å
            d.mt_guardianName = `${d.mt_guardianPrefix || ''} ${d.mt_guardianFirstName || ''} ${d.mt_guardianLastName || ''}`.trim();
            d.mt_studentFullName = `${d.mt_studentPrefix || ''}${d.mt_studentFirstName || ''} ${d.mt_studentLastName || ''}`.trim();
            d.mt_fatherFullName = `${d.mt_fatherPrefix || ''} ${d.mt_fatherFirstName || ''} ${d.mt_fatherLastName || ''}`.trim();
            d.mt_motherFullName = `${d.mt_motherPrefix || ''} ${d.mt_motherFirstName || ''} ${d.mt_motherLastName || ''}`.trim();
            d.mt_altGuardianName = `${d.mt_altGuardianPrefix || ''} ${d.mt_altGuardianFirstName || ''} ${d.mt_altGuardianLastName || ''}`.trim();
            return d;
        }

        function mtCb(checked) {
            return `<span class="mt-box">${checked ? '‚úì' : ''}</span>`;
        }

        function mtIdBoxes(id) {
            const raw = (id || '').replace(/[^0-9]/g, '');
            if (raw.length !== 13) {
                let boxes = '';
                for (let i = 0; i < 13; i++) {
                    if (i === 1 || i === 5 || i === 10 || i === 12) boxes += '<span class="mt-id-dash"></span>';
                    boxes += '<span class="mt-id-box"></span>';
                }
                return boxes;
            }
            let boxes = '';
            raw.split('').forEach((digit, i) => {
                if (i === 1 || i === 5 || i === 10 || i === 12) boxes += '<span class="mt-id-dash"></span>';
                boxes += `<span class="mt-id-box">${digit}</span>`;
            });
            return boxes;
        }

        function val(v, placeholder) {
            const str = (v || '').toString().trim();
            if (!str || str === '-') return `<span class="mt-line" style="min-width:${placeholder ? placeholder : '80px'}">&nbsp;</span>`;
            return `<span class="mt-line">${str}</span>`;
        }

        function generateMobtuaDocumentHTML(d) {
            const logoUrl = 'https://nonthaphathr.github.io/uploadimg/logoschool.png';
            const guardianRelation = d.mt_guardianRelation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? (d.mt_guardianRelationOther || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') : (d.mt_guardianRelation || '');
            const transports = Array.isArray(d.mt_transport) ? d.mt_transport : (d.mt_transport ? [d.mt_transport] : []);
            const studentIdClean = (d.mt_studentNationalId || '').replace(/[^0-9]/g, '');

            function parentStatusCb(status) {
                const opts = ['‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô', '‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà', '‡∏≠‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á', '‡∏ö‡∏¥‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï', '‡∏°‡∏≤‡∏£‡∏î‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï'];
                return opts.map(o => `${mtCb(d.mt_parentStatus === o)} ${o}`).join(' &nbsp; ');
            }

            return `
<div class="mobtua-doc">

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ 1 -->
  <div class="mobtua-page-1">
    <div class="mt-code">‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205</div>
    <div class="mt-doc-header-row">
        <img src="${logoUrl}" class="mt-logo" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ">
        <div class="mt-title-center">
            <h2 style="font-size:17px; font-weight:700; margin:0;">‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
            <p style="font-size:15px; font-weight:600; margin:2px 0 0;">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
        </div>
        <div class="mt-topright">
            <div>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß ${val(d.mt_studentId)}</div>
            <div>‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô ${val(d.mt_classRoom, '60px')}</div>
            <div>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${val(d.mt_academicYear)}</div>
        </div>
    </div>

    <p class="mt-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span style="font-weight:400; font-size:12px;">(‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ö‡∏£‡∏£‡∏à‡∏á)</span></p>

    <p class="mt-para mt-nowrap">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤(‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á) ${val(d.mt_guardianName, '150px')} ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ${val(d.mt_guardianNationalId, '130px')}</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ${val(d.mt_guardianOccupation, '100px')} ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ${val(d.mt_guardianWorkplace, '180px')}</p>
    <p class="mt-para mt-nowrap">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${val(d.mt_guardianHouseNo, '35px')} ‡∏´‡∏°‡∏π‡πà ${val(d.mt_guardianMoo, '25px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_guardianSubdistrict, '80px')} ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_guardianDistrict, '80px')} ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_guardianProvince, '70px')}</p>
    <p class="mt-para mt-nowrap">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå ${val(d.mt_guardianPostal, '45px')} ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡πâ‡∏≤‡∏ô ${val(d.mt_guardianHomePhone, '90px')} ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_guardianMobile, '90px')}</p>
    <p class="mt-para mt-nowrap">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡πá‡∏ô
        ${mtCb(guardianRelation === '‡∏ö‡∏¥‡∏î‡∏≤')} ‡∏ö‡∏¥‡∏î‡∏≤ &nbsp;
        ${mtCb(guardianRelation === '‡∏°‡∏≤‡∏£‡∏î‡∏≤')} ‡∏°‡∏≤‡∏£‡∏î‡∏≤ &nbsp;
        ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏ ${val(guardianRelation !== '‡∏ö‡∏¥‡∏î‡∏≤' && guardianRelation !== '‡∏°‡∏≤‡∏£‡∏î‡∏≤' ? guardianRelation : '', '70px')} &nbsp;
        ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${val(d.mt_guardianIncome, '55px')} ‡∏ö‡∏≤‡∏ó
    </p>

    <p class="mt-section-title" style="margin-top:6px;">‡∏Ç‡∏≠‡∏ó‡∏≥‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
    <p class="mt-para mt-nowrap">‡∏î‡πâ‡∏ß‡∏¢ (‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏™‡∏Å‡∏∏‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) ${val(d.mt_studentFullName, '200px')} ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô ${val(d.mt_studentNickname, '70px')}</p>
    <p class="mt-para mt-nowrap">‡πÄ‡∏Å‡∏¥‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${val(d.mt_birthDay, '22px')} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${val(d.mt_birthMonth, '70px')} ‡∏û.‡∏®. ${val(d.mt_birthYear, '42px')} ‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_nationality, '55px')} ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_ethnicity, '55px')}</p>
    <p class="mt-para mt-nowrap">‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ${val(d.mt_religion, '48px')} ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á ${val(d.mt_height, '35px')} ‡∏ã.‡∏°. ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ${val(d.mt_weight, '35px')} ‡∏Å.‡∏Å. ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ${val(d.mt_disease, '90px')}</p>
    <p class="mt-para">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="mt-id-boxes">${mtIdBoxes(d.mt_studentNationalId)}</span></p>

    <p class="mt-section-title">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô(‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô)</p>
    <p class="mt-para mt-nowrap">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô ${val(d.mt_houseCode, '100px')} ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${val(d.mt_houseNo, '30px')} ‡∏´‡∏°‡∏π‡πà ${val(d.mt_moo, '25px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_subdistrict, '80px')}</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_district, '75px')} ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_province, '75px')} ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå ${val(d.mt_postal, '45px')} ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_mobile, '85px')}</p>

    <p class="mt-section-title">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô(‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</p>
    <p class="mt-para mt-nowrap">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô ${val(d.mt_curHouseCode, '100px')} ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${val(d.mt_curHouseNo, '30px')} ‡∏´‡∏°‡∏π‡πà ${val(d.mt_curMoo, '25px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_curSubdistrict, '80px')}</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_curDistrict, '75px')} ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_curProvince, '75px')} ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå ${val(d.mt_curPostal, '45px')} ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_curMobile, '85px')}</p>

    <p class="mt-para mt-nowrap">‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ô‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        ${mtCb(d.mt_sleeping === '‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥')} ‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥ &nbsp;
        ${mtCb(d.mt_sleeping === '‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤')} ‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤ &nbsp;
        ${mtCb(d.mt_sleeping === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ')} ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏ ${val(d.mt_sleepingOther, '70px')}
    </p>
    <p class="mt-para mt-nowrap">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ &nbsp;
        ${mtCb(d.mt_disadvantaged === '‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™')} ‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ &nbsp;&nbsp;
        ${mtCb(d.mt_disadvantaged === '‡πÑ‡∏°‡πà‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™')} ‡πÑ‡∏°‡πà‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™
    </p>
    <p class="mt-para mt-nowrap">‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô &nbsp;
        ${mtCb(transports.includes('‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤'))} ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤ &nbsp;
        ${mtCb(transports.includes('‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô'))} ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô &nbsp;
        ${mtCb(transports.includes('‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á'))} ‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á &nbsp;
        ${mtCb(transports.includes('‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå'))} ‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå &nbsp;
        ${mtCb(transports.includes('‡∏≠‡∏∑‡πà‡∏ô‡πÜ'))} ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏ ${val(d.mt_transportOther, '60px')}
    </p>
    <p class="mt-para mt-nowrap">‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${val(d.mt_travelTime, '35px')} ‡∏ô‡∏≤‡∏ó‡∏µ &nbsp; ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${val(d.mt_travelDistance, '90px')}</p>
    <p class="mt-para mt-nowrap">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ${val(d.mt_siblings, '28px')} ‡∏Ñ‡∏ô (‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢) &nbsp; ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢ ${val(d.mt_olderBrothers, '22px')} ‡∏Ñ‡∏ô &nbsp; ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢ ${val(d.mt_youngerBrothers, '22px')} ‡∏Ñ‡∏ô</p>
    <p class="mt-para mt-nowrap">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß ${val(d.mt_olderSisters, '22px')} ‡∏Ñ‡∏ô &nbsp; ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß ${val(d.mt_youngerSisters, '22px')} ‡∏Ñ‡∏ô &nbsp; ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡∏π‡πà ${val(d.mt_siblingsStudying, '30px')} ‡∏Ñ‡∏ô</p>
    <p class="mt-para mt-nowrap">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏∏‡∏ï‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà ${val(d.mt_birthOrder, '28px')} ‡πÉ‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ${val(d.mt_siblings, '28px')} ‡∏Ñ‡∏ô (‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢)</p>

    <p class="mt-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</p>
    <p class="mt-para mt-nowrap"><strong>‡∏ö‡∏¥‡∏î‡∏≤</strong> ${val(d.mt_fatherFullName, '180px')} ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ${val(d.mt_fatherNationalId, '115px')}</p>
    <p class="mt-para mt-nowrap">‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_fatherNationality, '42px')} ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_fatherEthnicity, '42px')} ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ${val(d.mt_fatherReligion, '42px')} &nbsp;
        ( ${d.mt_fatherAlive === '‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà' ? '‚úì' : '&nbsp;'} ) ‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà &nbsp; ( ${d.mt_fatherAlive === '‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï' ? '‚úì' : '&nbsp;'} ) ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï &nbsp; ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${val(d.mt_fatherEducation, '55px')}</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ${val(d.mt_fatherOccupation, '75px')} ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ${val(d.mt_fatherWorkplace, '85px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_fatherSubdistrict, '65px')} ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_fatherDistrict, '65px')}</p>
    <p class="mt-para mt-nowrap">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_fatherProvince, '65px')} ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${val(d.mt_fatherIncome, '48px')} ‡∏ö‡∏≤‡∏ó &nbsp; ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_fatherMobile, '85px')}</p>

    <p class="mt-para mt-nowrap" style="margin-top:5px;"><strong>‡∏°‡∏≤‡∏£‡∏î‡∏≤</strong> ${val(d.mt_motherFullName, '180px')} ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ${val(d.mt_motherNationalId, '115px')}</p>
    <p class="mt-para mt-nowrap">‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_motherNationality, '42px')} ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_motherEthnicity, '42px')} ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ${val(d.mt_motherReligion, '42px')} &nbsp;
        ( ${d.mt_motherAlive === '‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà' ? '‚úì' : '&nbsp;'} ) ‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà &nbsp; ( ${d.mt_motherAlive === '‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï' ? '‚úì' : '&nbsp;'} ) ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï &nbsp; ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${val(d.mt_motherEducation, '55px')}</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ${val(d.mt_motherOccupation, '75px')} ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ${val(d.mt_motherWorkplace, '85px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_motherSubdistrict, '65px')} ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_motherDistrict, '65px')}</p>
    <p class="mt-para mt-nowrap">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_motherProvince, '65px')} ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${val(d.mt_motherIncome, '48px')} ‡∏ö‡∏≤‡∏ó &nbsp; ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_motherMobile, '85px')}</p>
  </div>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ 2 -->
  <div class="mobtua-page-2">
    <div class="mt-code" style="margin-top:4px;">‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205</div>

    <p class="mt-para mt-nowrap" style="margin-top:4px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤ ‡∏°‡∏≤‡∏£‡∏î‡∏≤ &nbsp; ${parentStatusCb(d.mt_parentStatus)} &nbsp;
    ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏£‡∏∞‡∏ö‡∏∏ ${val(d.mt_parentStatus === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? d.mt_parentStatusOther : '', '70px')}</p>

    <p class="mt-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤)</p>
    <p class="mt-para mt-nowrap">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ${val(d.mt_altGuardianName, '180px')} ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô ${val(d.mt_altGuardianRelation, '80px')}</p>
    <p class="mt-para mt-nowrap">‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_altGuardianNationality, '48px')} ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ ${val(d.mt_altGuardianEthnicity, '48px')} ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ${val(d.mt_altGuardianReligion, '48px')} ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ${val(d.mt_altGuardianOccupation, '75px')} ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${val(d.mt_altGuardianIncome, '48px')} ‡∏ö‡∏≤‡∏ó</p>
    <p class="mt-para mt-nowrap">‡∏≠‡∏¢‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${val(d.mt_altGuardianHouseNo, '30px')} ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà ${val(d.mt_altGuardianMoo, '22px')} ‡∏ñ‡∏ô‡∏ô ${val(d.mt_altGuardianRoad, '75px')} ‡∏ï‡∏≥‡∏ö‡∏• ${val(d.mt_altGuardianSubdistrict, '75px')} ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ${val(d.mt_altGuardianDistrict, '75px')}</p>
    <p class="mt-para mt-nowrap">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ${val(d.mt_altGuardianProvince, '65px')} ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ${val(d.mt_altGuardianWorkplace, '95px')} ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ${val(d.mt_altGuardianMobile, '90px')}</p>

    <p class="mt-para" style="margin-top:10px;">‡∏ö‡∏±‡∏î‡∏ô‡∏µ‡πâ <strong>${val(d.mt_studentFullName, '200px')}</strong> ‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
    <p class="mt-para">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡∏Ñ‡∏≠‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö ‡∏î‡∏π‡πÅ‡∏• ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà <strong>${val(d.mt_studentFullName, '200px')}</strong> ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
    <p class="mt-para">‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏≠‡∏ö‡∏£‡∏° ‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡∏™‡∏±‡πà‡∏á‡∏™‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£</p>
    <p class="mt-para">‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏°‡∏≠‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</p>
    <p class="mt-para">‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£ ‡∏´‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
    <p class="mt-para">‡πÑ‡∏î‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏ì‡∏µ ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß</p>
    <p class="mt-para">‡∏à‡∏∂‡∏á‡∏•‡∏á‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</p>

    <div class="mt-sig-row">
        <div class="mt-sig-block">
            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠......................................................................‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</p>
            <p>(${val(d.mt_guardianName, '150px')})</p>
            <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà..............‡πÄ‡∏î‡∏∑‡∏≠‡∏ô.....................‡∏û.‡∏®..............</p>
        </div>
        <div class="mt-sig-block">
            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠......................................................................‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</p>
            <p>(...........................................................................)</p>
            <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà..............‡πÄ‡∏î‡∏∑‡∏≠‡∏ô.....................‡∏û.‡∏®..............</p>
        </div>
    </div>

    <div class="mt-divider" style="margin-top:14px;"></div>
    <p class="mt-section-title">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡πà‡∏ô‡∏ß‡∏±‡∏ô‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</p>
    <div class="mt-doclist">
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤ ‡∏õ‡∏û.1 (‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤)</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏£‡∏î‡∏≤</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏£‡∏î‡∏≤</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤)</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤/‡∏°‡∏≤‡∏£‡∏î‡∏≤)</div>
        <div class="mt-doclist-item">${mtCb(false)} ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
    </div>
    <p style="font-size:12px; font-weight:700; margin-top:6px;">***‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏â‡∏ö‡∏±‡∏ö ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
  </div>

</div>`;
        }

        function previewMobtuaDocument() {
            const form = document.getElementById('mobtuaForm');
            if (!form.checkValidity()) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                form.reportValidity();
                return;
            }
            const d = getMobtuaFormData();
            const html = generateMobtuaDocumentHTML(d);
            document.getElementById('mobtuaPreviewArea').innerHTML = html;
            document.getElementById('mobtuaPrintArea').innerHTML = html;
            document.getElementById('mobtuaPreviewModal').classList.add('active');
        }

        async function saveMobtuaDocument() {
            const form = document.getElementById('mobtuaForm');
            if (!form.checkValidity()) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                form.reportValidity();
                return;
            }
            const d = getMobtuaFormData();
            try {
                showLoading(true);
                const record = {
                    formType: '‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                    formCode: '‡∏ß‡∏Å.‡∏Å‡∏ó‡∏ß.205',
                    studentName: d.mt_studentFullName || '',
                    guardianName: d.mt_guardianName || '',
                    academicYear: d.mt_academicYear || '',
                    classRoom: d.mt_classRoom || '',
                    data: d,
                    createdAt: window.firestore.serverTimestamp(),
                    updatedAt: window.firestore.serverTimestamp()
                };
                await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'mobtua'),
                    record
                );
                showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                const html = generateMobtuaDocumentHTML(d);
                document.getElementById('mobtuaPreviewArea').innerHTML = html;
                document.getElementById('mobtuaPrintArea').innerHTML = html;
                document.getElementById('mobtuaPreviewModal').classList.add('active');
                await loadMobtuaHistory();
                // ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞ autosave ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                document.getElementById('mobtuaForm').reset();
                clearAutosave(AUTOSAVE_KEY_MOBTUA);
                // reset autosave setup flag ‡πÉ‡∏´‡πâ event listener ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
                const mf = document.getElementById('mobtuaForm');
                if (mf) mf._autosaveSetup = false;
            } catch (error) {
                console.error('Error saving mobtua:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function loadMobtuaHistory() {
            try {
                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'mobtua'),
                    window.firestore.orderBy('createdAt', 'desc'),
                    window.firestore.limit(50)
                );
                const snap = await window.firestore.getDocs(q);
                const records = [];
                snap.forEach(doc => records.push({ id: doc.id, ...doc.data() }));

                const list = document.getElementById('mobtuaHistoryList');
                const count = document.getElementById('mobtuaHistoryCount');
                if (!list) return;
                count.textContent = records.length;

                const isLocked = localStorage.getItem('historyLocked') === 'true';

                if (records.length === 0) {
                    list.innerHTML = `<div class="empty-history">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width:48px;height:48px;opacity:0.4;margin-bottom:0.5rem;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</p></div>`;
                    return;
                }

                list.innerHTML = records.map(rec => {
                    let dateStr = '-';
                    if (rec.createdAt) {
                        dateStr = rec.createdAt.toDate().toLocaleDateString('th-TH', {
                            year: 'numeric', month: 'short', day: 'numeric',
                            hour: '2-digit', minute: '2-digit'
                        });
                    }
                    const actionBtns = isLocked
                        ? `<span style="font-size:var(--text-xs);color:var(--text-light);">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>`
                        : `<button class="btn btn-danger btn-sm" onclick="deleteMobtuaRecord('${rec.id}')">üóëÔ∏è ‡∏•‡∏ö</button>`;

                    return `<div class="history-item" style="border-left: 3px solid #9c4dcc;">
                        <div class="history-item-header">
                            <span class="history-item-type" style="background:#7b3f9e;">‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</span>
                            <span class="history-item-date">${dateStr}</span>
                        </div>
                        <div class="history-item-name">${rec.studentName || '-'}</div>
                        <div class="history-item-detail">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${rec.academicYear || '-'} | ${rec.classRoom || '-'} | ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á: ${rec.guardianName || '-'}</div>
                        <div class="history-item-actions">
                            <button class="btn btn-primary btn-sm" style="background:#7b3f9e;" onclick="viewMobtuaRecord('${rec.id}')">üëÅÔ∏è ‡∏î‡∏π</button>
                            ${actionBtns}
                        </div>
                    </div>`;
                }).join('');
            } catch(e) {
                console.error('loadMobtuaHistory error:', e);
            }
        }

        async function viewMobtuaRecord(id) {
            try {
                showLoading(true);
                const snap = await window.firestore.getDoc(window.firestore.doc(window.db, 'mobtua', id));
                if (!snap.exists()) { showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error'); return; }
                const html = generateMobtuaDocumentHTML(snap.data().data);
                document.getElementById('mobtuaPreviewArea').innerHTML = html;
                document.getElementById('mobtuaPrintArea').innerHTML = html;
                document.getElementById('mobtuaPreviewModal').classList.add('active');
            } catch(e) {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + e.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function deleteMobtuaRecord(id) {
            if (localStorage.getItem('historyLocked') === 'true') {
                showToast('‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ', 'error'); return;
            }
            const pw = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö:');
            if (pw === null) return;
            if (pw !== '1111') { showToast('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error'); return; }
            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) return;
            try {
                showLoading(true);
                await window.firestore.deleteDoc(window.firestore.doc(window.db, 'mobtua', id));
                showToast('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                await loadMobtuaHistory();
            } catch(e) {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + e.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function exportMobtuaToExcel() {
            try {
                showLoading(true);
                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'mobtua'),
                    window.firestore.orderBy('createdAt', 'desc')
                );
                const snap = await window.firestore.getDocs(q);
                const rows = [];
                snap.forEach(doc => {
                    const r = doc.data();
                    const d = r.data || {};
                    const transports = Array.isArray(d.mt_transport) ? d.mt_transport.join(', ') : (d.mt_transport || '-');
                    rows.push({
                        // ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
                        '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å':         r.createdAt ? new Date(r.createdAt.toDate()).toLocaleDateString('th-TH') : '-',
                        '‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤':           d.mt_academicYear || '-',
                        '‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á':            d.mt_classRoom || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':  d.mt_studentId || '-',
                        // ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':   r.studentName || '-',
                        '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô':             d.mt_studentNickname || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':      (d.mt_studentNationalId || '').replace(/-/g,''),
                        '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î(‡∏ß‡∏±‡∏ô)':         d.mt_birthDay || '-',
                        '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î(‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)':       d.mt_birthMonth || '-',
                        '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î(‡∏õ‡∏µ‡∏û.‡∏®.)':     d.mt_birthYear || '-',
                        '‡∏≠‡∏≤‡∏¢‡∏∏':                 d.mt_age || '-',
                        '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å(‡∏Å‡∏Å.)':         d.mt_weight || '-',
                        '‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á(‡∏ã‡∏°.)':         d.mt_height || '-',
                        '‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':      d.mt_nationality || '-',
                        '‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':    d.mt_ethnicity || '-',
                        '‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':        d.mt_religion || '-',
                        '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß':          d.mt_disease || '-',
                        '‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™':         d.mt_disadvantaged || '-',
                        '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°':         d.mt_previousSchool || '-',
                        '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î':  d.mt_siblings || '-',
                        '‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢':               d.mt_olderBrothers || '-',
                        '‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß':               d.mt_olderSisters || '-',
                        '‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢':              d.mt_youngerBrothers || '-',
                        '‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß':              d.mt_youngerSisters || '-',
                        '‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏®‡∏∂‡∏Å‡∏©‡∏≤':    d.mt_siblingsStudying || '-',
                        '‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏∏‡∏ï‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà':        d.mt_birthOrder || '-',
                        '‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å':               d.mt_sleeping === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? (d.mt_sleepingOther||'‡∏≠‡∏∑‡πà‡∏ô‡πÜ') : (d.mt_sleeping||'-'),
                        '‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á':           transports + (d.mt_transportOther ? ` (${d.mt_transportOther})` : ''),
                        '‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á(‡∏Å‡∏°.)':         d.mt_travelDistance || '-',
                        '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á(‡∏ô‡∏≤‡∏ó‡∏µ)':    d.mt_travelTime || '-',
                        // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        '‡∏£‡∏´‡∏±‡∏™‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':     d.mt_houseCode || '-',
                        '‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':   d.mt_houseNo || '-',
                        '‡∏´‡∏°‡∏π‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':         d.mt_moo || '-',
                        '‡∏ï‡∏≥‡∏ö‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':         d.mt_subdistrict || '-',
                        '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':        d.mt_district || '-',
                        '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':      d.mt_province || '-',
                        '‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': d.mt_postal || '-',
                        '‡πÇ‡∏ó‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô':          d.mt_mobile || '-',
                        // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                        '‡∏£‡∏´‡∏±‡∏™‡∏ö‡πâ‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':     d.mt_curHouseCode || '-',
                        '‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':   d.mt_curHouseNo || '-',
                        '‡∏´‡∏°‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':         d.mt_curMoo || '-',
                        '‡∏ï‡∏≥‡∏ö‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':         d.mt_curSubdistrict || '-',
                        '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':        d.mt_curDistrict || '-',
                        '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':      d.mt_curProvince || '-',
                        '‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':     d.mt_curPostal || '-',
                        '‡πÇ‡∏ó‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô':          d.mt_curMobile || '-',
                        // ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á
                        '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':        r.guardianName || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':     (d.mt_guardianNationalId || '').replace(/-/g,''),
                        '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á': d.mt_guardianRelation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? (d.mt_guardianRelationOther||'‡∏≠‡∏∑‡πà‡∏ô‡πÜ') : (d.mt_guardianRelation||'-'),
                        '‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':       d.mt_guardianOccupation || '-',
                        '‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':    d.mt_guardianWorkplace || '-',
                        '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':      d.mt_guardianIncome || '-',
                        '‡πÇ‡∏ó‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':     d.mt_guardianHomePhone || '-',
                        '‡πÇ‡∏ó‡∏£‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':   d.mt_guardianMobile || '-',
                        '‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':  d.mt_guardianHouseNo || '-',
                        '‡∏´‡∏°‡∏π‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':        d.mt_guardianMoo || '-',
                        '‡∏ï‡∏≥‡∏ö‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':        d.mt_guardianSubdistrict || '-',
                        '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':       d.mt_guardianDistrict || '-',
                        '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':     d.mt_guardianProvince || '-',
                        '‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á':    d.mt_guardianPostal || '-',
                        // ‡∏ö‡∏¥‡∏î‡∏≤
                        '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ö‡∏¥‡∏î‡∏≤':        d.mt_fatherFullName || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏ö‡∏¥‡∏î‡∏≤':          (d.mt_fatherNationalId || '').replace(/-/g,''),
                        '‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏ö‡∏¥‡∏î‡∏≤':          d.mt_fatherNationality || '-',
                        '‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏ö‡∏¥‡∏î‡∏≤':        d.mt_fatherEthnicity || '-',
                        '‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏ö‡∏¥‡∏î‡∏≤':            d.mt_fatherReligion || '-',
                        '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏¥‡∏î‡∏≤':            d.mt_fatherAlive || '-',
                        '‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ö‡∏¥‡∏î‡∏≤':         d.mt_fatherEducation || '-',
                        '‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ö‡∏¥‡∏î‡∏≤':            d.mt_fatherOccupation || '-',
                        '‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤':         d.mt_fatherWorkplace || '-',
                        '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏¥‡∏î‡∏≤':           d.mt_fatherIncome || '-',
                        '‡πÇ‡∏ó‡∏£‡∏ö‡∏¥‡∏î‡∏≤':              d.mt_fatherMobile || '-',
                        '‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡∏¥‡∏î‡∏≤':             d.mt_fatherSubdistrict || '-',
                        '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏¥‡∏î‡∏≤':            d.mt_fatherDistrict || '-',
                        '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ö‡∏¥‡∏î‡∏≤':          d.mt_fatherProvince || '-',
                        // ‡∏°‡∏≤‡∏£‡∏î‡∏≤
                        '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤':       d.mt_motherFullName || '-',
                        '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏°‡∏≤‡∏£‡∏î‡∏≤':         (d.mt_motherNationalId || '').replace(/-/g,''),
                        '‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏≤‡∏£‡∏î‡∏≤':         d.mt_motherNationality || '-',
                        '‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏≤‡∏£‡∏î‡∏≤':       d.mt_motherEthnicity || '-',
                        '‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤':           d.mt_motherReligion || '-',
                        '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏°‡∏≤‡∏£‡∏î‡∏≤':           d.mt_motherAlive || '-',
                        '‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤':        d.mt_motherEducation || '-',
                        '‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏°‡∏≤‡∏£‡∏î‡∏≤':           d.mt_motherOccupation || '-',
                        '‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤':        d.mt_motherWorkplace || '-',
                        '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏£‡∏î‡∏≤':          d.mt_motherIncome || '-',
                        '‡πÇ‡∏ó‡∏£‡∏°‡∏≤‡∏£‡∏î‡∏≤':             d.mt_motherMobile || '-',
                        '‡∏ï‡∏≥‡∏ö‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤':            d.mt_motherSubdistrict || '-',
                        '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏°‡∏≤‡∏£‡∏î‡∏≤':           d.mt_motherDistrict || '-',
                        '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏°‡∏≤‡∏£‡∏î‡∏≤':         d.mt_motherProvince || '-',
                        // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û
                        '‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤-‡∏°‡∏≤‡∏£‡∏î‡∏≤':   d.mt_parentStatus === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? (d.mt_parentStatusOther||'‡∏≠‡∏∑‡πà‡∏ô‡πÜ') : (d.mt_parentStatus||'-'),
                        // ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏î‡πÅ‡∏ó‡∏ô
                        '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':   d.mt_altGuardianName || '-',
                        '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':    d.mt_altGuardianRelation || '-',
                        '‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':         d.mt_altGuardianNationality || '-',
                        '‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':       d.mt_altGuardianEthnicity || '-',
                        '‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':           d.mt_altGuardianReligion || '-',
                        '‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':           d.mt_altGuardianOccupation || '-',
                        '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':          d.mt_altGuardianIncome || '-',
                        '‡πÇ‡∏ó‡∏£‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':             d.mt_altGuardianMobile || '-',
                        '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏î‡πÅ‡∏ó‡∏ô':         [d.mt_altGuardianHouseNo, d.mt_altGuardianMoo && `‡∏´‡∏°‡∏π‡πà${d.mt_altGuardianMoo}`, d.mt_altGuardianRoad && `‡∏ñ.${d.mt_altGuardianRoad}`, d.mt_altGuardianSubdistrict && `‡∏ï.${d.mt_altGuardianSubdistrict}`, d.mt_altGuardianDistrict && `‡∏≠.${d.mt_altGuardianDistrict}`, d.mt_altGuardianProvince && `‡∏à.${d.mt_altGuardianProvince}`].filter(Boolean).join(' ') || '-',
                    });
                });
                if (rows.length === 0) { showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', 'error'); return; }
                const headers = Object.keys(rows[0]);
                const csv = [
                    '\ufeff' + headers.join(','),
                    ...rows.map(row => headers.map(h => `"${(row[h]||'').toString().replace(/"/g,'""')}"`).join(','))
                ].join('\n');
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                const today = new Date().toLocaleDateString('th-TH').replace(/\//g,'-');
                a.href = url; a.download = `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß_${today}.csv`;
                document.body.appendChild(a); a.click(); document.body.removeChild(a);
                showToast('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            } catch(e) {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + e.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        // ========== AUTOSAVE SYSTEM ==========
        const AUTOSAVE_KEY_MOBTUA = 'autosave_mobtua';
        const AUTOSAVE_KEY_ADMISSION = 'autosave_admission';
        const autosaveTimers = {};

        function autosaveForm(formId, storageKey) {
            const form = document.getElementById(formId);
            if (!form) return;
            const fd = new FormData(form);
            const data = {};
            for (let [k, v] of fd.entries()) {
                if (!data[k]) data[k] = v;
                else if (Array.isArray(data[k])) data[k].push(v);
                else data[k] = [data[k], v];
            }
            localStorage.setItem(storageKey, JSON.stringify({ data, savedAt: new Date().toISOString() }));
        }

        function restoreForm(formId, storageKey) {
            const saved = localStorage.getItem(storageKey);
            if (!saved) return false;
            try {
                const { data, savedAt } = JSON.parse(saved);
                const form = document.getElementById(formId);
                if (!form) return false;
                Object.entries(data).forEach(([name, value]) => {
                    const values = Array.isArray(value) ? value : [value];
                    const els = form.querySelectorAll(`[name="${name}"]`);
                    els.forEach(el => {
                        if (el.type === 'checkbox' || el.type === 'radio') {
                            el.checked = values.includes(el.value);
                        } else {
                            el.value = values[0] || '';
                        }
                    });
                });
                return savedAt;
            } catch(e) {
                console.warn('Restore autosave failed:', e);
                return false;
            }
        }

        function setupAutosave(formId, storageKey, debounceMs = 1500) {
            const form = document.getElementById(formId);
            if (!form) return;
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô register ‡∏ã‡πâ‡∏≥
            if (form._autosaveSetup) return;
            form._autosaveSetup = true;
            const trigger = () => {
                clearTimeout(autosaveTimers[storageKey]);
                autosaveTimers[storageKey] = setTimeout(() => {
                    autosaveForm(formId, storageKey);
                    showAutosaveBadge(storageKey);
                }, debounceMs);
            };
            form.addEventListener('input', trigger);
            form.addEventListener('change', trigger);
        }

        function showAutosaveBadge(storageKey) {
            const badgeId = storageKey === AUTOSAVE_KEY_MOBTUA ? 'autosaveBadgeMobtua' : 'autosaveBadgeAdmission';
            const badge = document.getElementById(badgeId);
            if (!badge) return;
            badge.textContent = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ' + new Date().toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'});
            badge.style.opacity = '1';
            clearTimeout(badge._hideTimer);
            badge._hideTimer = setTimeout(() => { badge.style.opacity = '0'; }, 3000);
        }

        function clearAutosave(storageKey) {
            localStorage.removeItem(storageKey);
        }

        function promptRestoreAutosave(formId, storageKey) {
            const savedAt = restoreForm(formId, storageKey);
            if (savedAt) {
                const dt = new Date(savedAt).toLocaleString('th-TH');
                const badgeId = storageKey === AUTOSAVE_KEY_MOBTUA ? 'autosaveBadgeMobtua' : 'autosaveBadgeAdmission';
                const badge = document.getElementById(badgeId);
                if (badge) {
                    badge.textContent = `üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (${dt})`;
                    badge.style.opacity = '1';
                    clearTimeout(badge._hideTimer);
                    badge._hideTimer = setTimeout(() => { badge.style.opacity = '0'; }, 5000);
                }
                // trigger age calc
                if (formId === 'mobtuaForm') {
                    document.getElementById('mt_birthDay')?.dispatchEvent(new Event('change'));
                } else {
                    document.getElementById('birthDay')?.dispatchEvent(new Event('change'));
                }
                // trigger talent checkbox visibility
                if (formId === 'admissionForm') {
                    ['sports','music','other'].forEach(v => {
                        const cb = document.querySelector(`input[name="talent"][value="${v}"]`);
                        if (cb) cb.dispatchEvent(new Event('change'));
                    });
                }
                return true;
            }
            return false;
        }

        function printMobtuaDocument() {
            // ‡∏ï‡∏±‡πâ‡∏á flag ‡∏ö‡∏ô body ‡πÉ‡∏´‡πâ CSS print ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏°‡∏≠‡∏ö‡∏ï‡∏±‡∏ß
            document.body.setAttribute('data-print', 'mobtua');
            const mobtuaPrint = document.getElementById('mobtuaPrintArea');
            mobtuaPrint.style.display = 'block';
            setTimeout(() => {
                window.print();
                document.body.removeAttribute('data-print');
                mobtuaPrint.style.display = 'none';
            }, 200);
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.addEventListener('DOMContentLoaded', () => {
            loadHistory();
            setTimeout(showAlertIfEnabled, 500);
            setupMobtuaEvents();

            // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            const testModeEnabled = localStorage.getItem('testModeEnabled') === 'true';
            toggleTestModeButton(testModeEnabled);

            // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πá‡∏≠‡∏Ñ
            const historyLocked = localStorage.getItem('historyLocked') === 'true';
            applyHistoryLockUI(historyLocked);

            // ‡∏ï‡∏±‡πâ‡∏á Autosave ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£
            setupAutosave('admissionForm', AUTOSAVE_KEY_ADMISSION);
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£
            promptRestoreAutosave('admissionForm', AUTOSAVE_KEY_ADMISSION);
        });
    </script>
</body>
</html>
